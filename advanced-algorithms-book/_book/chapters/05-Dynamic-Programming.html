<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>6&nbsp; Advanced Algorithms: A Journey Through Computational Problem Solving – Advanced Computational Algorithms</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/04-Greedy-Algorithms.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-9b98f18118eee809be1c051eb5cc78e4.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/01-introduction.html">Core Concepts</a></li><li class="breadcrumb-item"><a href="../chapters/05-Dynamic-Programming.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Advanced Algorithms: A Journey Through Computational Problem Solving</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Advanced Computational Algorithms</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Preface</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Advanced Computational Algorithms</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Core Concepts</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/01-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Advanced Algorithms: A Journey Through Computational Problem Solving</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/02-Divide-and-Conquer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Advanced Algorithms: A Journey Through Computational Problem Solving</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/03-Data-Structures-for-Efficiency.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Chapter 3: Data Structures for Efficiency</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/04-Greedy-Algorithms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Chapter 4: Greedy Algorithms - When Local Optimality Leads to Global Solutions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/05-Dynamic-Programming.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Advanced Algorithms: A Journey Through Computational Problem Solving</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#chapter-5-dynamic-programming---when-subproblems-overlap" id="toc-chapter-5-dynamic-programming---when-subproblems-overlap" class="nav-link active" data-scroll-target="#chapter-5-dynamic-programming---when-subproblems-overlap"><span class="header-section-number">6.1</span> Chapter 5: Dynamic Programming - When Subproblems Overlap</a></li>
  <li><a href="#welcome-to-the-world-of-memoization" id="toc-welcome-to-the-world-of-memoization" class="nav-link" data-scroll-target="#welcome-to-the-world-of-memoization"><span class="header-section-number">6.2</span> Welcome to the World of Memoization</a>
  <ul class="collapse">
  <li><a href="#why-this-matters" id="toc-why-this-matters" class="nav-link" data-scroll-target="#why-this-matters"><span class="header-section-number">6.2.1</span> Why This Matters</a></li>
  <li><a href="#what-youll-learn" id="toc-what-youll-learn" class="nav-link" data-scroll-target="#what-youll-learn"><span class="header-section-number">6.2.2</span> What You’ll Learn</a></li>
  <li><a href="#chapter-roadmap" id="toc-chapter-roadmap" class="nav-link" data-scroll-target="#chapter-roadmap"><span class="header-section-number">6.2.3</span> Chapter Roadmap</a></li>
  </ul></li>
  <li><a href="#section-5.1-the-problem-with-naive-recursion" id="toc-section-5.1-the-problem-with-naive-recursion" class="nav-link" data-scroll-target="#section-5.1-the-problem-with-naive-recursion"><span class="header-section-number">6.3</span> Section 5.1: The Problem with Naive Recursion</a>
  <ul class="collapse">
  <li><a href="#fibonacci-a-cautionary-tale" id="toc-fibonacci-a-cautionary-tale" class="nav-link" data-scroll-target="#fibonacci-a-cautionary-tale"><span class="header-section-number">6.3.1</span> Fibonacci: A Cautionary Tale</a></li>
  <li><a href="#counting-the-catastrophe" id="toc-counting-the-catastrophe" class="nav-link" data-scroll-target="#counting-the-catastrophe"><span class="header-section-number">6.3.2</span> Counting the Catastrophe</a></li>
  <li><a href="#enter-dynamic-programming-memoization" id="toc-enter-dynamic-programming-memoization" class="nav-link" data-scroll-target="#enter-dynamic-programming-memoization"><span class="header-section-number">6.3.3</span> Enter Dynamic Programming: Memoization</a></li>
  <li><a href="#the-two-fundamental-properties" id="toc-the-two-fundamental-properties" class="nav-link" data-scroll-target="#the-two-fundamental-properties"><span class="header-section-number">6.3.4</span> The Two Fundamental Properties</a></li>
  <li><a href="#tabulation-the-bottom-up-alternative" id="toc-tabulation-the-bottom-up-alternative" class="nav-link" data-scroll-target="#tabulation-the-bottom-up-alternative"><span class="header-section-number">6.3.5</span> Tabulation: The Bottom-Up Alternative</a></li>
  <li><a href="#space-optimization-using-only-what-you-need" id="toc-space-optimization-using-only-what-you-need" class="nav-link" data-scroll-target="#space-optimization-using-only-what-you-need"><span class="header-section-number">6.3.6</span> Space Optimization: Using Only What You Need</a></li>
  <li><a href="#comparing-all-approaches" id="toc-comparing-all-approaches" class="nav-link" data-scroll-target="#comparing-all-approaches"><span class="header-section-number">6.3.7</span> Comparing All Approaches</a></li>
  <li><a href="#key-insights-for-dp-design" id="toc-key-insights-for-dp-design" class="nav-link" data-scroll-target="#key-insights-for-dp-design"><span class="header-section-number">6.3.8</span> Key Insights for DP Design</a></li>
  </ul></li>
  <li><a href="#section-5.2-the-dynamic-programming-design-process" id="toc-section-5.2-the-dynamic-programming-design-process" class="nav-link" data-scroll-target="#section-5.2-the-dynamic-programming-design-process"><span class="header-section-number">6.4</span> Section 5.2: The Dynamic Programming Design Process</a>
  <ul class="collapse">
  <li><a href="#a-systematic-approach-to-dp-problems" id="toc-a-systematic-approach-to-dp-problems" class="nav-link" data-scroll-target="#a-systematic-approach-to-dp-problems"><span class="header-section-number">6.4.1</span> A Systematic Approach to DP Problems</a></li>
  <li><a href="#step-1-characterize-the-structure-of-optimal-solutions" id="toc-step-1-characterize-the-structure-of-optimal-solutions" class="nav-link" data-scroll-target="#step-1-characterize-the-structure-of-optimal-solutions"><span class="header-section-number">6.4.2</span> Step 1: Characterize the Structure of Optimal Solutions</a></li>
  <li><a href="#step-2-define-the-recurrence-relation-precisely" id="toc-step-2-define-the-recurrence-relation-precisely" class="nav-link" data-scroll-target="#step-2-define-the-recurrence-relation-precisely"><span class="header-section-number">6.4.3</span> Step 2: Define the Recurrence Relation Precisely</a></li>
  <li><a href="#step-3-identify-overlapping-subproblems" id="toc-step-3-identify-overlapping-subproblems" class="nav-link" data-scroll-target="#step-3-identify-overlapping-subproblems"><span class="header-section-number">6.4.4</span> Step 3: Identify Overlapping Subproblems</a></li>
  <li><a href="#step-4-implement-bottom-up-tabulation" id="toc-step-4-implement-bottom-up-tabulation" class="nav-link" data-scroll-target="#step-4-implement-bottom-up-tabulation"><span class="header-section-number">6.4.5</span> Step 4: Implement Bottom-Up (Tabulation)</a></li>
  <li><a href="#step-5-extract-the-solution-which-items-to-take" id="toc-step-5-extract-the-solution-which-items-to-take" class="nav-link" data-scroll-target="#step-5-extract-the-solution-which-items-to-take"><span class="header-section-number">6.4.6</span> Step 5: Extract the Solution (Which Items to Take)</a></li>
  <li><a href="#step-6-optimize-space-when-possible" id="toc-step-6-optimize-space-when-possible" class="nav-link" data-scroll-target="#step-6-optimize-space-when-possible"><span class="header-section-number">6.4.7</span> Step 6: Optimize Space (When Possible)</a></li>
  <li><a href="#complexity-analysis" id="toc-complexity-analysis" class="nav-link" data-scroll-target="#complexity-analysis"><span class="header-section-number">6.4.8</span> Complexity Analysis</a></li>
  </ul></li>
  <li><a href="#section-5.3-sequence-alignment-and-edit-distance" id="toc-section-5.3-sequence-alignment-and-edit-distance" class="nav-link" data-scroll-target="#section-5.3-sequence-alignment-and-edit-distance"><span class="header-section-number">6.5</span> Section 5.3: Sequence Alignment and Edit Distance</a>
  <ul class="collapse">
  <li><a href="#dna-diff-and-dynamic-programming" id="toc-dna-diff-and-dynamic-programming" class="nav-link" data-scroll-target="#dna-diff-and-dynamic-programming"><span class="header-section-number">6.5.1</span> DNA, Diff, and Dynamic Programming</a></li>
  <li><a href="#the-longest-common-subsequence-lcs-problem" id="toc-the-longest-common-subsequence-lcs-problem" class="nav-link" data-scroll-target="#the-longest-common-subsequence-lcs-problem"><span class="header-section-number">6.5.2</span> The Longest Common Subsequence (LCS) Problem</a></li>
  </ul></li>
  <li><a href="#section-5.4-matrix-chain-multiplication" id="toc-section-5.4-matrix-chain-multiplication" class="nav-link" data-scroll-target="#section-5.4-matrix-chain-multiplication"><span class="header-section-number">6.6</span> Section 5.4: Matrix Chain Multiplication</a>
  <ul class="collapse">
  <li><a href="#the-parenthesization-problem" id="toc-the-parenthesization-problem" class="nav-link" data-scroll-target="#the-parenthesization-problem"><span class="header-section-number">6.6.1</span> The Parenthesization Problem</a></li>
  <li><a href="#the-matrix-chain-problem" id="toc-the-matrix-chain-problem" class="nav-link" data-scroll-target="#the-matrix-chain-problem"><span class="header-section-number">6.6.2</span> The Matrix Chain Problem</a></li>
  <li><a href="#developing-the-solution" id="toc-developing-the-solution" class="nav-link" data-scroll-target="#developing-the-solution"><span class="header-section-number">6.6.3</span> Developing the Solution</a></li>
  <li><a href="#matrix-chain-implementation" id="toc-matrix-chain-implementation" class="nav-link" data-scroll-target="#matrix-chain-implementation"><span class="header-section-number">6.6.4</span> Matrix Chain Implementation</a></li>
  <li><a href="#tracing-through-an-example" id="toc-tracing-through-an-example" class="nav-link" data-scroll-target="#tracing-through-an-example"><span class="header-section-number">6.6.5</span> Tracing Through an Example</a></li>
  <li><a href="#complexity-analysis-1" id="toc-complexity-analysis-1" class="nav-link" data-scroll-target="#complexity-analysis-1"><span class="header-section-number">6.6.6</span> Complexity Analysis</a></li>
  </ul></li>
  <li><a href="#section-5.5-advanced-dp-patterns-and-optimization" id="toc-section-5.5-advanced-dp-patterns-and-optimization" class="nav-link" data-scroll-target="#section-5.5-advanced-dp-patterns-and-optimization"><span class="header-section-number">6.7</span> Section 5.5: Advanced DP Patterns and Optimization</a>
  <ul class="collapse">
  <li><a href="#common-dp-patterns" id="toc-common-dp-patterns" class="nav-link" data-scroll-target="#common-dp-patterns"><span class="header-section-number">6.7.1</span> Common DP Patterns</a></li>
  <li><a href="#space-optimization-techniques" id="toc-space-optimization-techniques" class="nav-link" data-scroll-target="#space-optimization-techniques"><span class="header-section-number">6.7.2</span> Space Optimization Techniques</a></li>
  <li><a href="#dp-optimization-checklist" id="toc-dp-optimization-checklist" class="nav-link" data-scroll-target="#dp-optimization-checklist"><span class="header-section-number">6.7.3</span> DP Optimization Checklist</a></li>
  </ul></li>
  <li><a href="#section-5.6-project---dynamic-programming-library" id="toc-section-5.6-project---dynamic-programming-library" class="nav-link" data-scroll-target="#section-5.6-project---dynamic-programming-library"><span class="header-section-number">6.8</span> Section 5.6: Project - Dynamic Programming Library</a>
  <ul class="collapse">
  <li><a href="#project-overview" id="toc-project-overview" class="nav-link" data-scroll-target="#project-overview"><span class="header-section-number">6.8.1</span> Project Overview</a></li>
  <li><a href="#project-structure" id="toc-project-structure" class="nav-link" data-scroll-target="#project-structure"><span class="header-section-number">6.8.2</span> Project Structure</a></li>
  <li><a href="#core-implementation-dp-base-class" id="toc-core-implementation-dp-base-class" class="nav-link" data-scroll-target="#core-implementation-dp-base-class"><span class="header-section-number">6.8.3</span> Core Implementation: DP Base Class</a></li>
  <li><a href="#example-knapsack-implementation" id="toc-example-knapsack-implementation" class="nav-link" data-scroll-target="#example-knapsack-implementation"><span class="header-section-number">6.8.4</span> Example: Knapsack Implementation</a></li>
  <li><a href="#visualization-component" id="toc-visualization-component" class="nav-link" data-scroll-target="#visualization-component"><span class="header-section-number">6.8.5</span> Visualization Component</a></li>
  <li><a href="#real-world-example-dna-alignment-tool" id="toc-real-world-example-dna-alignment-tool" class="nav-link" data-scroll-target="#real-world-example-dna-alignment-tool"><span class="header-section-number">6.8.6</span> Real-World Example: DNA Alignment Tool</a></li>
  <li><a href="#testing-suite" id="toc-testing-suite" class="nav-link" data-scroll-target="#testing-suite"><span class="header-section-number">6.8.7</span> Testing Suite</a></li>
  </ul></li>
  <li><a href="#chapter-5-exercises" id="toc-chapter-5-exercises" class="nav-link" data-scroll-target="#chapter-5-exercises"><span class="header-section-number">6.9</span> Chapter 5 Exercises</a>
  <ul class="collapse">
  <li><a href="#theoretical-problems" id="toc-theoretical-problems" class="nav-link" data-scroll-target="#theoretical-problems"><span class="header-section-number">6.9.1</span> Theoretical Problems</a></li>
  <li><a href="#programming-problems" id="toc-programming-problems" class="nav-link" data-scroll-target="#programming-problems"><span class="header-section-number">6.9.2</span> Programming Problems</a></li>
  <li><a href="#implementation-challenges" id="toc-implementation-challenges" class="nav-link" data-scroll-target="#implementation-challenges"><span class="header-section-number">6.9.3</span> Implementation Challenges</a></li>
  <li><a href="#analysis-problems" id="toc-analysis-problems" class="nav-link" data-scroll-target="#analysis-problems"><span class="header-section-number">6.9.4</span> Analysis Problems</a></li>
  </ul></li>
  <li><a href="#chapter-5-summary" id="toc-chapter-5-summary" class="nav-link" data-scroll-target="#chapter-5-summary"><span class="header-section-number">6.10</span> Chapter 5 Summary</a>
  <ul class="collapse">
  <li><a href="#key-takeaways" id="toc-key-takeaways" class="nav-link" data-scroll-target="#key-takeaways"><span class="header-section-number">6.10.1</span> Key Takeaways</a></li>
  <li><a href="#whats-next" id="toc-whats-next" class="nav-link" data-scroll-target="#whats-next"><span class="header-section-number">6.10.2</span> What’s Next</a></li>
  <li><a href="#final-thought" id="toc-final-thought" class="nav-link" data-scroll-target="#final-thought"><span class="header-section-number">6.10.3</span> Final Thought</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/01-introduction.html">Core Concepts</a></li><li class="breadcrumb-item"><a href="../chapters/05-Dynamic-Programming.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Advanced Algorithms: A Journey Through Computational Problem Solving</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Advanced Algorithms: A Journey Through Computational Problem Solving</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="chapter-5-dynamic-programming---when-subproblems-overlap" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="chapter-5-dynamic-programming---when-subproblems-overlap"><span class="header-section-number">6.1</span> Chapter 5: Dynamic Programming - When Subproblems Overlap</h2>
<p><em>“Those who cannot remember the past are condemned to repeat it.” - George Santayana (and also, apparently, algorithms)</em></p>
<hr>
</section>
<section id="welcome-to-the-world-of-memoization" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="welcome-to-the-world-of-memoization"><span class="header-section-number">6.2</span> Welcome to the World of Memoization</h2>
<p>Imagine you’re climbing a staircase with 100 steps, and you can take either 1 or 2 steps at a time. How many different ways can you reach the top? If you tried to solve this with the divide and conquer techniques from Chapter 2, you’d find yourself computing the same subproblems over and over again—millions of times! Your computer would still be calculating when the sun burns out.</p>
<p>But what if you could <strong>remember</strong> the answers to subproblems you’ve already solved? What if, instead of recomputing “how many ways to reach step 50” a million times, you computed it once and wrote it down? This simple idea—<strong>remembering solutions to avoid redundant work</strong>—is the heart of dynamic programming, and it transforms problems from impossible to instant.</p>
<p>Dynamic programming (DP) is like divide and conquer’s clever sibling. Both break problems into smaller subproblems, but there’s a crucial difference:</p>
<p><strong>Divide and Conquer:</strong> Subproblems are <strong>independent</strong> (solving one doesn’t help with others) <strong>Dynamic Programming:</strong> Subproblems <strong>overlap</strong> (the same subproblems appear repeatedly)</p>
<p>This overlap is the key. When subproblems repeat, we can solve each one just once, store the solution, and look it up whenever needed. The result? Algorithms that would take exponential time can suddenly run in polynomial time—the difference between “impossible” and “instant.”</p>
<section id="why-this-matters" class="level3" data-number="6.2.1">
<h3 data-number="6.2.1" class="anchored" data-anchor-id="why-this-matters"><span class="header-section-number">6.2.1</span> Why This Matters</h3>
<p>Dynamic programming isn’t just an academic exercise. It’s the secret sauce behind some of the most important algorithms in computing:</p>
<p><strong>🧬 Bioinformatics:</strong> DNA sequence alignment uses DP to compare genetic codes, enabling personalized medicine and evolutionary biology research.</p>
<p><strong>📝 Text Editors:</strong> The “diff” tool that shows differences between files? Dynamic programming. Version control systems like Git use it constantly.</p>
<p><strong>🗣️ Speech Recognition:</strong> Converting audio to text involves DP algorithms that find the most likely word sequence.</p>
<p><strong>💰 Finance:</strong> Portfolio optimization, option pricing, and risk management all use dynamic programming.</p>
<p><strong>🎮 Game AI:</strong> Optimal strategy calculation in games from chess to poker relies on DP techniques.</p>
<p><strong>📱 Autocorrect:</strong> When your phone suggests word corrections, it’s using edit distance—a classic DP algorithm.</p>
<p><strong>🚗 GPS Navigation:</strong> Finding shortest paths in maps with traffic patterns uses DP principles.</p>
</section>
<section id="what-youll-learn" class="level3" data-number="6.2.2">
<h3 data-number="6.2.2" class="anchored" data-anchor-id="what-youll-learn"><span class="header-section-number">6.2.2</span> What You’ll Learn</h3>
<p>This chapter will transform how you think about problem solving. You’ll master:</p>
<ol type="1">
<li><strong>Recognizing DP Problems:</strong> The telltale signs that a problem is crying out for dynamic programming</li>
<li><strong>The DP Design Pattern:</strong> A systematic approach to developing DP solutions</li>
<li><strong>Memoization vs Tabulation:</strong> Two complementary strategies for implementing DP</li>
<li><strong>Classic DP Problems:</strong> From Fibonacci to knapsack to sequence alignment</li>
<li><strong>Optimization Techniques:</strong> Space-saving tricks and advanced DP patterns</li>
<li><strong>Real-World Applications:</strong> How DP solves practical problems across domains</li>
</ol>
<p>Most importantly, you’ll develop <strong>DP intuition</strong>—the ability to spot overlapping subproblems and design efficient solutions. This intuition is a superpower that will serve you throughout your career.</p>
</section>
<section id="chapter-roadmap" class="level3" data-number="6.2.3">
<h3 data-number="6.2.3" class="anchored" data-anchor-id="chapter-roadmap"><span class="header-section-number">6.2.3</span> Chapter Roadmap</h3>
<p>We’ll build your understanding step by step:</p>
<ul>
<li><strong>Section 5.1:</strong> Introduces DP through the Fibonacci sequence, showing why naive recursion fails and how memoization saves the day</li>
<li><strong>Section 5.2:</strong> Develops the systematic DP design process with the classic knapsack problem</li>
<li><strong>Section 5.3:</strong> Explores sequence alignment problems (LCS, edit distance) critical for bioinformatics</li>
<li><strong>Section 5.4:</strong> Tackles matrix chain multiplication and optimal substructure</li>
<li><strong>Section 5.5:</strong> Shows space optimization techniques and advanced patterns</li>
<li><strong>Section 5.6:</strong> Connects DP to real-world applications and implementation strategies</li>
</ul>
<p>Unlike recursion in Chapter 2, which many students find challenging initially, DP often feels even MORE difficult at first. That’s completely normal! DP requires seeing problems from a new angle—thinking about optimal substructure and overlapping subproblems simultaneously. We’ll take it slowly, with plenty of examples and visualizations.</p>
<p>By the end of this chapter, you’ll look at recursive problems differently. You’ll ask: “Do subproblems overlap? Can I reuse solutions? What should I memoize?” These questions will unlock solutions to problems that initially seem impossible.</p>
<p>Let’s begin by understanding why we need dynamic programming at all!</p>
<hr>
</section>
</section>
<section id="section-5.1-the-problem-with-naive-recursion" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="section-5.1-the-problem-with-naive-recursion"><span class="header-section-number">6.3</span> Section 5.1: The Problem with Naive Recursion</h2>
<section id="fibonacci-a-cautionary-tale" class="level3" data-number="6.3.1">
<h3 data-number="6.3.1" class="anchored" data-anchor-id="fibonacci-a-cautionary-tale"><span class="header-section-number">6.3.1</span> Fibonacci: A Cautionary Tale</h3>
<p>Let’s start with one of the most famous sequences in mathematics: the Fibonacci numbers.</p>
<p><strong>Definition:</strong></p>
<pre><code>F(0) = 0
F(1) = 1
F(n) = F(n-1) + F(n-2) for n ≥ 2

Sequence: 0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144...</code></pre>
<p>This recursive definition seems perfect for a recursive implementation:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fibonacci_naive(n):</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Compute the nth Fibonacci number using naive recursion.</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Time Complexity: O(2^n) - EXPONENTIAL! 💀</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Space Complexity: O(n) for recursion stack</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">        n: Index in Fibonacci sequence</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">        </span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co">        The nth Fibonacci number</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co">        </span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co">    Example:</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co">        &gt;&gt;&gt; fibonacci_naive(6)</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co">        8</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Base cases</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">&lt;=</span> <span class="dv">1</span>:</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> n</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Recursive case</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fibonacci_naive(n <span class="op">-</span> <span class="dv">1</span>) <span class="op">+</span> fibonacci_naive(n <span class="op">-</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This looks elegant! The code mirrors the mathematical definition perfectly. But let’s see what happens when we run it:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(fibonacci_naive(<span class="dv">5</span>))   <span class="co"># Returns: 5      (instant)</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(fibonacci_naive(<span class="dv">10</span>))  <span class="co"># Returns: 55     (instant)</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(fibonacci_naive(<span class="dv">20</span>))  <span class="co"># Returns: 6765   (instant)</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(fibonacci_naive(<span class="dv">30</span>))  <span class="co"># Returns: 832040 (takes ~1 second)</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(fibonacci_naive(<span class="dv">40</span>))  <span class="co"># Returns: ???    (takes ~1 minute!)</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(fibonacci_naive(<span class="dv">50</span>))  <span class="co"># Returns: ???    (would take hours!)</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(fibonacci_naive(<span class="dv">100</span>)) <span class="co"># Returns: ???    (would take millennia!)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>What’s going wrong?</strong> Let’s visualize the recursion tree for <code>fibonacci_naive(5)</code>:</p>
<pre><code>                              fib(5)
                           /           \
                      fib(4)           fib(3)
                     /      \          /      \
                fib(3)    fib(2)   fib(2)   fib(1)
               /     \    /    \    /    \      |
           fib(2) fib(1) fib(1) fib(0) fib(1) fib(0)  1
           /    \    |      |      |      |      |
       fib(1) fib(0) 1      1      0      1      0
          |      |
          1      0

Total function calls: 15 to compute fib(5)!</code></pre>
<p><strong>The problem:</strong> We compute the same values repeatedly:</p>
<ul>
<li><code>fib(3)</code> is computed <strong>2 times</strong></li>
<li><code>fib(2)</code> is computed <strong>3 times</strong></li>
<li><code>fib(1)</code> is computed <strong>5 times</strong></li>
<li><code>fib(0)</code> is computed <strong>3 times</strong></li>
</ul>
<p>For larger n, this duplication explodes exponentially!</p>
</section>
<section id="counting-the-catastrophe" class="level3" data-number="6.3.2">
<h3 data-number="6.3.2" class="anchored" data-anchor-id="counting-the-catastrophe"><span class="header-section-number">6.3.2</span> Counting the Catastrophe</h3>
<p>Let’s analyze exactly how bad this is:</p>
<p><strong>Recurrence for number of calls:</strong></p>
<pre><code>C(n) = C(n-1) + C(n-2) + 1

where:
- C(n-1) + C(n-2) = recursive calls
- +1 = current call</code></pre>
<p><strong>Solution:</strong> This is approximately O(φ^n) where φ ≈ 1.618 (the golden ratio)</p>
<p>More practically, it’s <strong>O(2^n)</strong>—exponential growth!</p>
<p><strong>Impact:</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>n</th>
<th>Function Calls</th>
<th>Approximate Time (1M calls/sec)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>10</td>
<td>177</td>
<td>&lt; 1 millisecond</td>
</tr>
<tr class="even">
<td>20</td>
<td>21,891</td>
<td>~0.02 seconds</td>
</tr>
<tr class="odd">
<td>30</td>
<td>2,692,537</td>
<td>~2.7 seconds</td>
</tr>
<tr class="even">
<td>40</td>
<td>331,160,281</td>
<td>~5.5 minutes</td>
</tr>
<tr class="odd">
<td>50</td>
<td>40,730,022,147</td>
<td>~11 hours</td>
</tr>
<tr class="even">
<td>100</td>
<td>~1.77 × 10²¹</td>
<td>~56 million years!</td>
</tr>
</tbody>
</table>
<p>To compute <code>fib(100)</code>, we’d make more function calls than there are grains of sand on Earth!</p>
</section>
<section id="enter-dynamic-programming-memoization" class="level3" data-number="6.3.3">
<h3 data-number="6.3.3" class="anchored" data-anchor-id="enter-dynamic-programming-memoization"><span class="header-section-number">6.3.3</span> Enter Dynamic Programming: Memoization</h3>
<p>The solution is beautifully simple: <strong>remember what we’ve already computed</strong>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fibonacci_memoized(n, memo<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Compute nth Fibonacci number using memoization.</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Time Complexity: O(n) - each value computed once! 🎉</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Space Complexity: O(n) for memo dictionary + recursion stack</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">        n: Index in Fibonacci sequence</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">        memo: Dictionary storing computed values</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co">        </span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co">        The nth Fibonacci number</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize memo on first call</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> memo <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>        memo <span class="op">=</span> {}</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Base cases</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">&lt;=</span> <span class="dv">1</span>:</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> n</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if already computed</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="kw">in</span> memo:</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> memo[n]</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute and store result</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>    memo[n] <span class="op">=</span> fibonacci_memoized(n <span class="op">-</span> <span class="dv">1</span>, memo) <span class="op">+</span> fibonacci_memoized(n <span class="op">-</span> <span class="dv">2</span>, memo)</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> memo[n]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>What changed?</strong></p>
<ul>
<li>Added a <code>memo</code> dictionary to store computed values</li>
<li>Before computing <code>fib(n)</code>, we check if it’s in <code>memo</code></li>
<li>After computing <code>fib(n)</code>, we store it in <code>memo</code></li>
</ul>
<p><strong>Performance:</strong></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(fibonacci_memoized(<span class="dv">10</span>))   <span class="co"># 55     (instant)</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(fibonacci_memoized(<span class="dv">50</span>))   <span class="co"># ~      (instant!)</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(fibonacci_memoized(<span class="dv">100</span>))  <span class="co"># ~      (instant!)</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(fibonacci_memoized(<span class="dv">500</span>))  <span class="co"># ~      (instant!)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>The memoized recursion tree for fib(5):</strong></p>
<pre><code>                              fib(5) ← computed
                           /           \
                      fib(4) ← computed  fib(3) ← lookup! (already computed)
                     /      \          
                fib(3) ← computed    fib(2) ← lookup!
               /     \    
           fib(2) ← computed    fib(1) ← base case
           /    \    
       fib(1)  fib(0) ← base cases

Total unique computations: 6 (not 15!)
All subsequent calls are lookups: O(1)</code></pre>
<p><strong>Analysis:</strong></p>
<ul>
<li>Each Fibonacci number from 0 to n is computed exactly <strong>once</strong></li>
<li>All subsequent needs are satisfied by lookup</li>
<li><strong>Total time:</strong> O(n) instead of O(2^n)</li>
<li><strong>Speedup for n=50:</strong> From 11 hours to microseconds!</li>
</ul>
</section>
<section id="the-two-fundamental-properties" class="level3" data-number="6.3.4">
<h3 data-number="6.3.4" class="anchored" data-anchor-id="the-two-fundamental-properties"><span class="header-section-number">6.3.4</span> The Two Fundamental Properties</h3>
<p>This example reveals the two key properties that make a problem suitable for dynamic programming:</p>
<p><strong>1. Optimal Substructure</strong> The optimal solution to a problem can be constructed from optimal solutions to its subproblems.</p>
<p>For Fibonacci:</p>
<pre><code>fib(n) = fib(n-1) + fib(n-2)

The solution to fib(n) is built from solutions to smaller subproblems.</code></pre>
<p><strong>2. Overlapping Subproblems</strong> The same subproblems are solved multiple times in a naive recursive approach.</p>
<p>For Fibonacci:</p>
<pre><code>Computing fib(5) requires:
- fib(3) computed 2 times
- fib(2) computed 3 times
- fib(1) computed 5 times

These are overlapping subproblems!</code></pre>
<p><strong>Key insight:</strong> Divide and conquer (from Chapter 2) also has optimal substructure, but its subproblems are <strong>independent</strong>—they don’t overlap. In merge sort, we never sort the same subarray twice. That’s why divide and conquer doesn’t need memoization, but dynamic programming does!</p>
</section>
<section id="tabulation-the-bottom-up-alternative" class="level3" data-number="6.3.5">
<h3 data-number="6.3.5" class="anchored" data-anchor-id="tabulation-the-bottom-up-alternative"><span class="header-section-number">6.3.5</span> Tabulation: The Bottom-Up Alternative</h3>
<p>Memoization is <strong>top-down</strong>: we start with the big problem and recurse, storing results as we go. There’s an alternative approach called <strong>tabulation</strong> that’s <strong>bottom-up</strong>: we start with the smallest subproblems and build up.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fibonacci_tabulation(n):</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Compute nth Fibonacci number using tabulation (bottom-up DP).</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Time Complexity: O(n)</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Space Complexity: O(n) for table</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Advantages over memoization:</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co">    - No recursion (no stack overflow risk)</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co">    - Often faster in practice (no function call overhead)</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co">    - Easier to optimize space (see below)</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co">        n: Index in Fibonacci sequence</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co">        </span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="co">        The nth Fibonacci number</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Handle base cases</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">&lt;=</span> <span class="dv">1</span>:</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> n</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create table to store results</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    dp <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> (n <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Base cases</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>    dp[<span class="dv">0</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>    dp[<span class="dv">1</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fill table bottom-up</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>        dp[i] <span class="op">=</span> dp[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> dp[i <span class="op">-</span> <span class="dv">2</span>]</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dp[n]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>How it works:</strong></p>
<pre><code>n = 6

Step 0: dp = [0, 1, 0, 0, 0, 0, 0]  (base cases)
Step 1: dp = [0, 1, 1, 0, 0, 0, 0]  (dp[2] = dp[1] + dp[0])
Step 2: dp = [0, 1, 1, 2, 0, 0, 0]  (dp[3] = dp[2] + dp[1])
Step 3: dp = [0, 1, 1, 2, 3, 0, 0]  (dp[4] = dp[3] + dp[2])
Step 4: dp = [0, 1, 1, 2, 3, 5, 0]  (dp[5] = dp[4] + dp[3])
Step 5: dp = [0, 1, 1, 2, 3, 5, 8]  (dp[6] = dp[5] + dp[4])

Answer: dp[6] = 8 ✓</code></pre>
<p><strong>Advantages of tabulation:</strong></p>
<ul>
<li>No recursion overhead or stack overflow risk</li>
<li>All subproblems solved in predictable order</li>
<li>Often easier to optimize for space (next section)</li>
<li>Can be faster in practice (no function calls)</li>
</ul>
<p><strong>Advantages of memoization:</strong></p>
<ul>
<li>More intuitive (follows recursive definition)</li>
<li>Only computes needed subproblems</li>
<li>Sometimes easier to code initially</li>
<li>Better for sparse problems (where many subproblems aren’t needed)</li>
</ul>
</section>
<section id="space-optimization-using-only-what-you-need" class="level3" data-number="6.3.6">
<h3 data-number="6.3.6" class="anchored" data-anchor-id="space-optimization-using-only-what-you-need"><span class="header-section-number">6.3.6</span> Space Optimization: Using Only What You Need</h3>
<p>Notice that to compute <code>fib(n)</code>, we only need the previous two values! We don’t need to store all n values:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fibonacci_optimized(n):</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Compute nth Fibonacci number with O(1) space.</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Time Complexity: O(n)</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Space Complexity: O(1) - only store last two values!</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co">    This is as efficient as possible for computing Fibonacci.</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">&lt;=</span> <span class="dv">1</span>:</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> n</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Only keep track of last two values</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    prev2 <span class="op">=</span> <span class="dv">0</span>  <span class="co"># fib(i-2)</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    prev1 <span class="op">=</span> <span class="dv">1</span>  <span class="co"># fib(i-1)</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>        current <span class="op">=</span> prev1 <span class="op">+</span> prev2</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>        prev2 <span class="op">=</span> prev1</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>        prev1 <span class="op">=</span> current</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prev1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Space complexity:</strong> O(1) instead of O(n)!</p>
<p>This optimization pattern appears frequently in DP problems.</p>
</section>
<section id="comparing-all-approaches" class="level3" data-number="6.3.7">
<h3 data-number="6.3.7" class="anchored" data-anchor-id="comparing-all-approaches"><span class="header-section-number">6.3.7</span> Comparing All Approaches</h3>
<p>Let’s summarize what we’ve learned:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Approach</th>
<th>Time</th>
<th>Space</th>
<th>Pros</th>
<th>Cons</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Naive Recursion</strong></td>
<td>O(2^n)</td>
<td>O(n)</td>
<td>Simple, matches definition</td>
<td>Exponentially slow</td>
</tr>
<tr class="even">
<td><strong>Memoization (Top-Down)</strong></td>
<td>O(n)</td>
<td>O(n)</td>
<td>Intuitive, only computes needed</td>
<td>Recursion overhead</td>
</tr>
<tr class="odd">
<td><strong>Tabulation (Bottom-Up)</strong></td>
<td>O(n)</td>
<td>O(n)</td>
<td>No recursion, predictable</td>
<td>Less intuitive initially</td>
</tr>
<tr class="even">
<td><strong>Space-Optimized</strong></td>
<td>O(n)</td>
<td>O(1)</td>
<td>Minimal memory</td>
<td>Only works for some problems</td>
</tr>
</tbody>
</table>
</section>
<section id="key-insights-for-dp-design" class="level3" data-number="6.3.8">
<h3 data-number="6.3.8" class="anchored" data-anchor-id="key-insights-for-dp-design"><span class="header-section-number">6.3.8</span> Key Insights for DP Design</h3>
<p>From the Fibonacci example, we learn the DP design pattern:</p>
<p><strong>Step 1: Identify the recursive structure</strong></p>
<ul>
<li>What’s the base case?</li>
<li>How do larger problems decompose into smaller ones?</li>
</ul>
<p><strong>Step 2: Check for overlapping subproblems</strong></p>
<ul>
<li>Draw the recursion tree</li>
<li>Do the same subproblems appear multiple times?</li>
</ul>
<p><strong>Step 3: Decide on state representation</strong></p>
<ul>
<li>What do we need to memoize?</li>
<li>For Fibonacci: just the index n</li>
</ul>
<p><strong>Step 4: Choose top-down or bottom-up</strong></p>
<ul>
<li>Memoization: Start from problem, recurse with caching</li>
<li>Tabulation: Start from base cases, build up</li>
</ul>
<p><strong>Step 5: Implement and optimize</strong></p>
<ul>
<li>Get it working first</li>
<li>Then optimize space if possible</li>
</ul>
<p>Let’s apply this pattern to more complex problems!</p>
<hr>
</section>
</section>
<section id="section-5.2-the-dynamic-programming-design-process" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="section-5.2-the-dynamic-programming-design-process"><span class="header-section-number">6.4</span> Section 5.2: The Dynamic Programming Design Process</h2>
<section id="a-systematic-approach-to-dp-problems" class="level3" data-number="6.4.1">
<h3 data-number="6.4.1" class="anchored" data-anchor-id="a-systematic-approach-to-dp-problems"><span class="header-section-number">6.4.1</span> A Systematic Approach to DP Problems</h3>
<p>Now that we understand the core idea, let’s develop a systematic process for tackling DP problems. We’ll use the classic <strong>0/1 Knapsack Problem</strong> as our running example.</p>
<p><strong>The 0/1 Knapsack Problem:</strong></p>
<p>You’re a thief robbing a store. You have a knapsack that can carry a maximum weight W. The store has n items, each with:</p>
<ul>
<li>A weight: w[i]</li>
<li>A value: v[i]</li>
</ul>
<p>You can either take an item (1) or leave it (0), hence “0/1” knapsack. You cannot take fractional items or take the same item multiple times.</p>
<p><strong>Goal:</strong> Maximize the total value of items you steal without exceeding weight capacity W.</p>
<p><strong>Example:</strong></p>
<pre><code>Capacity W = 7
Items:
  Item 1: weight=1, value=1   ($1/lb)
  Item 2: weight=3, value=4   ($1.33/lb)
  Item 3: weight=4, value=5   ($1.25/lb)
  Item 4: weight=5, value=7   ($1.40/lb)

What's the maximum value we can carry?</code></pre>
<p><strong>Greedy approach fails!</strong> You might think: “Take items with best value-to-weight ratio first.” But that doesn’t always work:</p>
<pre><code>Greedy by ratio: Item 4 ($1.40/lb) + Item 1 ($1/lb) 
= weight 6, value 8

Optimal solution: Item 2 + Item 3
= weight 7, value 9 ✓</code></pre>
<p>This is an <strong>optimization problem</strong> perfect for dynamic programming!</p>
</section>
<section id="step-1-characterize-the-structure-of-optimal-solutions" class="level3" data-number="6.4.2">
<h3 data-number="6.4.2" class="anchored" data-anchor-id="step-1-characterize-the-structure-of-optimal-solutions"><span class="header-section-number">6.4.2</span> Step 1: Characterize the Structure of Optimal Solutions</h3>
<p><strong>Key question:</strong> For the optimal solution, what decision do we make about the last item (item n)?</p>
<p><strong>Two possibilities:</strong></p>
<ol type="1">
<li><strong>Item n is in the optimal solution:</strong>
<ul>
<li>We get value v[n]</li>
<li>We use weight w[n]</li>
<li>We need optimal solution for remaining capacity (W - w[n]) using items 1…n-1</li>
</ul></li>
<li><strong>Item n is NOT in the optimal solution:</strong>
<ul>
<li>We get value 0 from item n</li>
<li>We use weight 0 from item n</li>
<li>We need optimal solution for full capacity W using items 1…n-1</li>
</ul></li>
</ol>
<p><strong>Recursive formulation:</strong></p>
<pre><code>Let K(i, w) = maximum value using items 1...i with capacity w

Base cases:
K(0, w) = 0  (no items, no value)
K(i, 0) = 0  (no capacity, no value)

Recursive case:
K(i, w) = max(
    K(i-1, w),                    // Don't take item i
    K(i-1, w - w[i]) + v[i]      // Take item i (if it fits)
)

Final answer: K(n, W)</code></pre>
<p>This is <strong>optimal substructure</strong>: the optimal solution contains optimal solutions to subproblems!</p>
</section>
<section id="step-2-define-the-recurrence-relation-precisely" class="level3" data-number="6.4.3">
<h3 data-number="6.4.3" class="anchored" data-anchor-id="step-2-define-the-recurrence-relation-precisely"><span class="header-section-number">6.4.3</span> Step 2: Define the Recurrence Relation Precisely</h3>
<p>Let’s formalize our recurrence:</p>
<pre><code>K(i, w) = maximum value achievable using first i items with capacity w

Base cases:
- K(0, w) = 0 for all w ≥ 0     (no items → no value)
- K(i, 0) = 0 for all i ≥ 0     (no capacity → no value)

Recursive case (for i &gt; 0, w &gt; 0):
If w[i] &gt; w:
    K(i, w) = K(i-1, w)          // Item too heavy, can't take it
Else:
    K(i, w) = max(
        K(i-1, w),               // Don't take item i
        K(i-1, w - w[i]) + v[i]  // Take item i
    )</code></pre>
</section>
<section id="step-3-identify-overlapping-subproblems" class="level3" data-number="6.4.4">
<h3 data-number="6.4.4" class="anchored" data-anchor-id="step-3-identify-overlapping-subproblems"><span class="header-section-number">6.4.4</span> Step 3: Identify Overlapping Subproblems</h3>
<p>Let’s trace through a small example to see the overlap:</p>
<pre><code>Items: [(w=2,v=3), (w=3,v=4), (w=4,v=5)]
Capacity W = 5

Computing K(3, 5):
  Needs: K(2, 5) and K(2, 1)
  
  K(2, 5) needs: K(1, 5) and K(1, 2)
  K(2, 1) needs: K(1, 1) and K(1, -2) [invalid]
  
  K(1, 5) needs: K(0, 5) and K(0, 3) [base cases]
  K(1, 2) needs: K(0, 2) and K(0, 0) [base cases]
  K(1, 1) needs: K(0, 1) [base case]

Notice: We need K(0, ...) for multiple different capacities
These are overlapping subproblems!</code></pre>
<p>Without memoization, we’d recompute the same K(i, w) values many times.</p>
</section>
<section id="step-4-implement-bottom-up-tabulation" class="level3" data-number="6.4.5">
<h3 data-number="6.4.5" class="anchored" data-anchor-id="step-4-implement-bottom-up-tabulation"><span class="header-section-number">6.4.5</span> Step 4: Implement Bottom-Up (Tabulation)</h3>
<p>For knapsack, tabulation is usually clearer than memoization. We’ll build a 2D table:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> knapsack_01(weights, values, capacity):</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Solve 0/1 knapsack problem using dynamic programming.</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Time Complexity: O(n * W) where n = number of items, W = capacity</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Space Complexity: O(n * W) for DP table</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co">        weights: List of item weights</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co">        values: List of item values  </span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co">        capacity: Maximum weight capacity</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co">        </span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="co">        Maximum value achievable</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="co">        </span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="co">    Example:</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="co">        &gt;&gt;&gt; weights = [1, 3, 4, 5]</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="co">        &gt;&gt;&gt; values = [1, 4, 5, 7]</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="co">        &gt;&gt;&gt; knapsack_01(weights, values, 7)</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="co">        9</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(weights)</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create DP table: dp[i][w] = max value using items 0..i-1 with capacity w</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add 1 to dimensions for base cases (0 items, 0 capacity)</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>    dp <span class="op">=</span> [[<span class="dv">0</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(capacity <span class="op">+</span> <span class="dv">1</span>)] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(n <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fill table bottom-up</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> w <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, capacity <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Current item index (0-indexed)</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>            item_idx <span class="op">=</span> i <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> weights[item_idx] <span class="op">&gt;</span> w:</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Item too heavy, can't include it</span></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>                dp[i][w] <span class="op">=</span> dp[i<span class="op">-</span><span class="dv">1</span>][w]</span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Max of: (don't take) vs (take item)</span></span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>                dp[i][w] <span class="op">=</span> <span class="bu">max</span>(</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>                    dp[i<span class="op">-</span><span class="dv">1</span>][w],                                    <span class="co"># Don't take</span></span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>                    dp[i<span class="op">-</span><span class="dv">1</span>][w <span class="op">-</span> weights[item_idx]] <span class="op">+</span> values[item_idx]  <span class="co"># Take</span></span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dp[n][capacity]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Let’s trace through our example:</strong></p>
<pre><code>Items: w=[1,3,4,5], v=[1,4,5,7], W=7

DP Table (dp[i][w] for items 0..i-1, capacity w):

     w: 0  1  2  3  4  5  6  7
i=0:    0  0  0  0  0  0  0  0  (no items)
i=1:    0  1  1  1  1  1  1  1  (item 0: w=1,v=1)
i=2:    0  1  1  4  5  5  5  5  (items 0-1: add w=3,v=4)
i=3:    0  1  1  4  5  6  6  9  (items 0-2: add w=4,v=5)
i=4:    0  1  1  4  5  7  8  9  (items 0-3: add w=5,v=7)

Answer: dp[4][7] = 9</code></pre>
<p><strong>How to read the table:</strong></p>
<ul>
<li><code>dp[2][5] = 5</code>: Using first 2 items with capacity 5, max value is 5</li>
<li><code>dp[3][7] = 9</code>: Using first 3 items with capacity 7, max value is 9 (items 1 and 2)</li>
<li><code>dp[4][7] = 9</code>: Using all 4 items with capacity 7, max value is still 9</li>
</ul>
</section>
<section id="step-5-extract-the-solution-which-items-to-take" class="level3" data-number="6.4.6">
<h3 data-number="6.4.6" class="anchored" data-anchor-id="step-5-extract-the-solution-which-items-to-take"><span class="header-section-number">6.4.6</span> Step 5: Extract the Solution (Which Items to Take)</h3>
<p>The DP table tells us the maximum value, but which items should we actually take?</p>
<p>We can <strong>backtrack</strong> through the table:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> knapsack_with_items(weights, values, capacity):</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Solve 0/1 knapsack and return both max value and items to take.</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co">        (max_value, selected_items) where selected_items is list of indices</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(weights)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    dp <span class="op">=</span> [[<span class="dv">0</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(capacity <span class="op">+</span> <span class="dv">1</span>)] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(n <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fill DP table (same as before)</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> w <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, capacity <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>            item_idx <span class="op">=</span> i <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> weights[item_idx] <span class="op">&gt;</span> w:</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>                dp[i][w] <span class="op">=</span> dp[i<span class="op">-</span><span class="dv">1</span>][w]</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>                dp[i][w] <span class="op">=</span> <span class="bu">max</span>(</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>                    dp[i<span class="op">-</span><span class="dv">1</span>][w],</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>                    dp[i<span class="op">-</span><span class="dv">1</span>][w <span class="op">-</span> weights[item_idx]] <span class="op">+</span> values[item_idx]</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Backtrack to find which items were taken</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>    selected <span class="op">=</span> []</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>    i <span class="op">=</span> n</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>    w <span class="op">=</span> capacity</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">and</span> w <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># If value came from including item i-1</span></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> dp[i][w] <span class="op">!=</span> dp[i<span class="op">-</span><span class="dv">1</span>][w]:</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>            item_idx <span class="op">=</span> i <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>            selected.append(item_idx)</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>            w <span class="op">-=</span> weights[item_idx]</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>        i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>    selected.reverse()  <span class="co"># Put in order items were considered</span></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dp[n][capacity], selected</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Backtracking logic:</strong></p>
<pre><code>Start at dp[4][7] = 9

Step 1: dp[4][7] = 9, dp[3][7] = 9
  → Same value, didn't take item 3

Step 2: dp[3][7] = 9, dp[2][7] = 5
  → Different! Took item 2 (w=4, v=5)
  → New capacity: 7 - 4 = 3

Step 3: dp[2][3] = 4, dp[1][3] = 1
  → Different! Took item 1 (w=3, v=4)
  → New capacity: 3 - 3 = 0

Step 4: Capacity = 0, stop

Selected items: [1, 2] (indices)
Items: w=3,v=4 and w=4,v=5
Total: weight=7, value=9 ✓</code></pre>
</section>
<section id="step-6-optimize-space-when-possible" class="level3" data-number="6.4.7">
<h3 data-number="6.4.7" class="anchored" data-anchor-id="step-6-optimize-space-when-possible"><span class="header-section-number">6.4.7</span> Step 6: Optimize Space (When Possible)</h3>
<p>Notice that each row of the DP table only depends on the previous row. We can use only two rows:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> knapsack_space_optimized(weights, values, capacity):</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Space-optimized 0/1 knapsack.</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Time Complexity: O(n * W)</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Space Complexity: O(W) - only one row!</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Trade-off: Can't easily backtrack to find which items were selected.</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(weights)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Only need current and previous row</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    prev <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> (capacity <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    curr <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> (capacity <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> w <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, capacity <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>            item_idx <span class="op">=</span> i <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> weights[item_idx] <span class="op">&gt;</span> w:</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>                curr[w] <span class="op">=</span> prev[w]</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>                curr[w] <span class="op">=</span> <span class="bu">max</span>(</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>                    prev[w],</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>                    prev[w <span class="op">-</span> weights[item_idx]] <span class="op">+</span> values[item_idx]</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Swap rows for next iteration</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>        prev, curr <span class="op">=</span> curr, prev</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prev[capacity]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Even better:</strong> We can use just ONE row if we iterate backwards!</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> knapsack_single_row(weights, values, capacity):</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Ultra space-optimized: single row, iterating backwards.</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Space Complexity: O(W)</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    dp <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> (capacity <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(weights)):</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Iterate backwards to avoid overwriting values we still need</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> w <span class="kw">in</span> <span class="bu">range</span>(capacity, weights[i] <span class="op">-</span> <span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>            dp[w] <span class="op">=</span> <span class="bu">max</span>(</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>                dp[w],</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>                dp[w <span class="op">-</span> weights[i]] <span class="op">+</span> values[i]</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dp[capacity]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Why backwards?</strong> If we go forwards, we might use the updated <code>dp[w - weight]</code> instead of the previous iteration’s value!</p>
</section>
<section id="complexity-analysis" class="level3" data-number="6.4.8">
<h3 data-number="6.4.8" class="anchored" data-anchor-id="complexity-analysis"><span class="header-section-number">6.4.8</span> Complexity Analysis</h3>
<p><strong>Time Complexity:</strong> O(n × W)</p>
<ul>
<li>n items to consider</li>
<li>W possible capacities to check</li>
<li>Each cell computed in O(1) time</li>
</ul>
<p><strong>Space Complexity:</strong></p>
<ul>
<li>Full table: O(n × W)</li>
<li>Two rows: O(W)</li>
<li>Single row: O(W)</li>
</ul>
<p><strong>Is this polynomial?</strong> Technically, it’s <strong>pseudo-polynomial</strong>!</p>
<ul>
<li>Polynomial in n (number of items)</li>
<li>But W (capacity) could be exponentially large in terms of its bit representation</li>
<li>Example: W = 2^100 requires 2^100 space/time, but only 100 bits to represent!</li>
</ul>
<p>For practical purposes where W is reasonable, this is very efficient.</p>
<hr>
</section>
</section>
<section id="section-5.3-sequence-alignment-and-edit-distance" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="section-5.3-sequence-alignment-and-edit-distance"><span class="header-section-number">6.5</span> Section 5.3: Sequence Alignment and Edit Distance</h2>
<section id="dna-diff-and-dynamic-programming" class="level3" data-number="6.5.1">
<h3 data-number="6.5.1" class="anchored" data-anchor-id="dna-diff-and-dynamic-programming"><span class="header-section-number">6.5.1</span> DNA, Diff, and Dynamic Programming</h3>
<p>One of the most important applications of dynamic programming is <strong>comparing sequences</strong>. Whether it’s:</p>
<ul>
<li><strong>DNA sequences</strong> in bioinformatics</li>
<li><strong>Text files</strong> in version control (diff/patch)</li>
<li><strong>Spell checking</strong> and autocorrect</li>
<li><strong>Plagiarism detection</strong></li>
<li><strong>Audio/video synchronization</strong></li>
</ul>
<p>The fundamental question is: <strong>How similar are two sequences?</strong></p>
</section>
<section id="the-longest-common-subsequence-lcs-problem" class="level3" data-number="6.5.2">
<h3 data-number="6.5.2" class="anchored" data-anchor-id="the-longest-common-subsequence-lcs-problem"><span class="header-section-number">6.5.2</span> The Longest Common Subsequence (LCS) Problem</h3>
<p><strong>Problem:</strong> Given two sequences, find the longest subsequence that appears in both (in the same order, but not necessarily consecutive).</p>
<p><strong>Example:</strong></p>
<pre><code>Sequence X = "ABCDGH"
Sequence Y = "AEDFHR"

Common subsequences: "A", "D", "H", "AD", "ADH", "AH"
Longest: "ADH" (length 3)</code></pre>
<p><strong>Note:</strong> This is different from longest common <strong>substring</strong> (which must be contiguous)!</p>
<p><strong>Applications:</strong></p>
<ul>
<li><strong>DNA alignment:</strong> How similar are two genetic sequences?</li>
<li><strong>File comparison:</strong> What lines changed between# Chapter 3: Dynamic Programming (Continued)</li>
</ul>
</section>
</section>
<section id="section-5.4-matrix-chain-multiplication" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="section-5.4-matrix-chain-multiplication"><span class="header-section-number">6.6</span> Section 5.4: Matrix Chain Multiplication</h2>
<section id="the-parenthesization-problem" class="level3" data-number="6.6.1">
<h3 data-number="6.6.1" class="anchored" data-anchor-id="the-parenthesization-problem"><span class="header-section-number">6.6.1</span> The Parenthesization Problem</h3>
<p>Matrix multiplication is associative: <code>(AB)C = A(BC)</code>, but the <strong>order matters for efficiency</strong>!</p>
<p><strong>Example:</strong> Consider multiplying three matrices:</p>
<ul>
<li>A: 10×30</li>
<li>B: 30×5</li>
<li>C: 5×60</li>
</ul>
<p><strong>Option 1: (AB)C</strong></p>
<ul>
<li>AB: 10×30 × 30×5 = 10×5 matrix, <strong>1,500 multiplications</strong></li>
<li>(AB)C: 10×5 × 5×60 = 10×60 matrix, <strong>3,000 multiplications</strong></li>
<li>Total: <strong>4,500 multiplications</strong></li>
</ul>
<p><strong>Option 2: A(BC)</strong></p>
<ul>
<li>BC: 30×5 × 5×60 = 30×60 matrix, <strong>9,000 multiplications</strong></li>
<li>A(BC): 10×30 × 30×60 = 10×60 matrix, <strong>18,000 multiplications</strong></li>
<li>Total: <strong>27,000 multiplications</strong></li>
</ul>
<p><strong>6x difference!</strong> For longer chains, the difference can be exponential.</p>
</section>
<section id="the-matrix-chain-problem" class="level3" data-number="6.6.2">
<h3 data-number="6.6.2" class="anchored" data-anchor-id="the-matrix-chain-problem"><span class="header-section-number">6.6.2</span> The Matrix Chain Problem</h3>
<p><strong>Given:</strong> A chain of matrices A₁, A₂, …, Aₙ with dimensions:</p>
<ul>
<li>A₁: p₀ × p₁</li>
<li>A₂: p₁ × p₂</li>
<li>…</li>
<li>Aₙ: pₙ₋₁ × pₙ</li>
</ul>
<p><strong>Find:</strong> The parenthesization that minimizes total scalar multiplications.</p>
</section>
<section id="developing-the-solution" class="level3" data-number="6.6.3">
<h3 data-number="6.6.3" class="anchored" data-anchor-id="developing-the-solution"><span class="header-section-number">6.6.3</span> Developing the Solution</h3>
<p><strong>Key Insight:</strong> The optimal solution has <strong>optimal substructure</strong>. If we split at position k:</p>
<pre><code>A₁..ₙ = (A₁..ₖ)(Aₖ₊₁..ₙ)</code></pre>
<p>Then both subchains must be parenthesized optimally!</p>
<p><strong>Recurrence:</strong></p>
<p>Let <code>M[i,j]</code> = minimum multiplications to compute Aᵢ through Aⱼ</p>
<pre><code>M[i,j] = {
    0                                    if i = j (single matrix)
    min(M[i,k] + M[k+1,j] + p_{i-1}·p_k·p_j)  for all i ≤ k &lt; j
}</code></pre>
<p>Where:</p>
<ul>
<li><code>M[i,k]</code> = cost to compute left subchain</li>
<li><code>M[k+1,j]</code> = cost to compute right subchain</li>
<li><code>p_{i-1}·p_k·p_j</code> = cost to multiply the two results</li>
</ul>
</section>
<section id="matrix-chain-implementation" class="level3" data-number="6.6.4">
<h3 data-number="6.6.4" class="anchored" data-anchor-id="matrix-chain-implementation"><span class="header-section-number">6.6.4</span> Matrix Chain Implementation</h3>
<div class="sourceCode" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> matrix_chain_order(dimensions):</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Find optimal parenthesization for matrix chain multiplication.</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co">        dimensions: List [p0, p1, ..., pn] where matrix i has dimensions p[i-1] × p[i]</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co">        </span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="co">        (min_cost, split_points) for optimal parenthesization</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="co">        </span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="co">    Example:</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="co">        &gt;&gt;&gt; dims = [10, 30, 5, 60]  # A1: 10×30, A2: 30×5, A3: 5×60</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="co">        &gt;&gt;&gt; cost, splits = matrix_chain_order(dims)</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="co">        &gt;&gt;&gt; cost</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="co">        4500</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(dimensions) <span class="op">-</span> <span class="dv">1</span>  <span class="co"># Number of matrices</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># M[i][j] = minimum cost to multiply matrices i through j</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>    M <span class="op">=</span> [[<span class="dv">0</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(n)] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(n)]</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># S[i][j] = optimal split point for matrices i through j</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>    S <span class="op">=</span> [[<span class="dv">0</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(n)] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(n)]</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># l is chain length (2 to n)</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> l <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n <span class="op">-</span> l <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>            j <span class="op">=</span> i <span class="op">+</span> l <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>            M[i][j] <span class="op">=</span> <span class="bu">float</span>(<span class="st">'inf'</span>)</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Try all possible split points</span></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(i, j):</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Cost = left chain + right chain + multiply results</span></span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>                cost <span class="op">=</span> (M[i][k] <span class="op">+</span> M[k<span class="op">+</span><span class="dv">1</span>][j] <span class="op">+</span> </span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>                       dimensions[i] <span class="op">*</span> dimensions[k<span class="op">+</span><span class="dv">1</span>] <span class="op">*</span> dimensions[j<span class="op">+</span><span class="dv">1</span>])</span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> cost <span class="op">&lt;</span> M[i][j]:</span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>                    M[i][j] <span class="op">=</span> cost</span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>                    S[i][j] <span class="op">=</span> k</span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> M[<span class="dv">0</span>][n<span class="op">-</span><span class="dv">1</span>], S</span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_optimal_parenthesization(S, i, j, matrix_names<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a><span class="co">    Recursively print the optimal parenthesization.</span></span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a><span class="co">        S: Split point matrix from matrix_chain_order</span></span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a><span class="co">        i, j: Range of matrices to parenthesize</span></span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a><span class="co">        matrix_names: Optional list of matrix names</span></span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> matrix_names <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true" tabindex="-1"></a>        matrix_names <span class="op">=</span> [<span class="ss">f"A</span><span class="sc">{</span>k<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(S))]</span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-56"><a href="#cb28-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">==</span> j:</span>
<span id="cb28-57"><a href="#cb28-57" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(matrix_names[i], end<span class="op">=</span><span class="st">''</span>)</span>
<span id="cb28-58"><a href="#cb28-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb28-59"><a href="#cb28-59" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'('</span>, end<span class="op">=</span><span class="st">''</span>)</span>
<span id="cb28-60"><a href="#cb28-60" aria-hidden="true" tabindex="-1"></a>        print_optimal_parenthesization(S, i, S[i][j], matrix_names)</span>
<span id="cb28-61"><a href="#cb28-61" aria-hidden="true" tabindex="-1"></a>        print_optimal_parenthesization(S, S[i][j] <span class="op">+</span> <span class="dv">1</span>, j, matrix_names)</span>
<span id="cb28-62"><a href="#cb28-62" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">')'</span>, end<span class="op">=</span><span class="st">''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="tracing-through-an-example" class="level3" data-number="6.6.5">
<h3 data-number="6.6.5" class="anchored" data-anchor-id="tracing-through-an-example"><span class="header-section-number">6.6.5</span> Tracing Through an Example</h3>
<div class="sourceCode" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: 4 matrices with dimensions</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>dims <span class="op">=</span> [<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">3</span>, <span class="dv">12</span>, <span class="dv">5</span>, <span class="dv">50</span>, <span class="dv">6</span>]</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co"># A1: 5×10, A2: 10×3, A3: 3×12, A4: 12×5, A5: 5×50, A6: 50×6</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>cost, splits <span class="op">=</span> matrix_chain_order(dims)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Minimum cost: </span><span class="sc">{</span>cost<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co"># DP table progression (partial):</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co"># M[i][j] for chain length 2:</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co"># M[0][1] = 5×10×3 = 150    (A1·A2)</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="co"># M[1][2] = 10×3×12 = 360   (A2·A3)</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="co"># M[2][3] = 3×12×5 = 180    (A3·A4)</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="co"># ...</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="co"># For chain length 3:</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="co"># M[0][2] = min(</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a><span class="co">#     M[0][0] + M[1][2] + 5×10×12 = 0 + 360 + 600 = 960,     k=0</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a><span class="co">#     M[0][1] + M[2][2] + 5×3×12 = 150 + 0 + 180 = 330       k=1 (best)</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a><span class="co"># ) = 330</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="complexity-analysis-1" class="level3" data-number="6.6.6">
<h3 data-number="6.6.6" class="anchored" data-anchor-id="complexity-analysis-1"><span class="header-section-number">6.6.6</span> Complexity Analysis</h3>
<p><strong>Time Complexity:</strong> O(n³)</p>
<ul>
<li>O(n²) table entries</li>
<li>O(n) work per entry (trying all split points)</li>
</ul>
<p><strong>Space Complexity:</strong> O(n²)</p>
<ul>
<li>Two n×n tables (M and S)</li>
</ul>
<p><strong>Compare to brute force:</strong></p>
<ul>
<li>Number of parenthesizations = Catalan number Cₙ₋₁ ≈ 4ⁿ/n^(3/2)</li>
<li>Exponential vs polynomial!</li>
</ul>
<hr>
</section>
</section>
<section id="section-5.5-advanced-dp-patterns-and-optimization" class="level2" data-number="6.7">
<h2 data-number="6.7" class="anchored" data-anchor-id="section-5.5-advanced-dp-patterns-and-optimization"><span class="header-section-number">6.7</span> Section 5.5: Advanced DP Patterns and Optimization</h2>
<section id="common-dp-patterns" class="level3" data-number="6.7.1">
<h3 data-number="6.7.1" class="anchored" data-anchor-id="common-dp-patterns"><span class="header-section-number">6.7.1</span> Common DP Patterns</h3>
<section id="interval-dp" class="level4" data-number="6.7.1.1">
<h4 data-number="6.7.1.1" class="anchored" data-anchor-id="interval-dp"><span class="header-section-number">6.7.1.1</span> 1. <strong>Interval DP</strong></h4>
<p>Problems defined over contiguous intervals/subarrays.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> optimal_binary_search_tree(keys, frequencies):</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Build optimal BST minimizing expected search cost.</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Pattern: Consider all ways to split interval [i,j]</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Similar to matrix chain multiplication.</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(keys)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># cost[i][j] = optimal cost for keys[i..j]</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    cost <span class="op">=</span> [[<span class="dv">0</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(n)] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(n)]</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Single keys</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>        cost[i][i] <span class="op">=</span> frequencies[i]</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Build larger intervals</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> length <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n <span class="op">-</span> length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>            j <span class="op">=</span> i <span class="op">+</span> length <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>            cost[i][j] <span class="op">=</span> <span class="bu">float</span>(<span class="st">'inf'</span>)</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Sum of frequencies in [i,j]</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>            freq_sum <span class="op">=</span> <span class="bu">sum</span>(frequencies[i:j<span class="op">+</span><span class="dv">1</span>])</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Try each key as root</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> root <span class="kw">in</span> <span class="bu">range</span>(i, j <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>                left_cost <span class="op">=</span> cost[i][root<span class="op">-</span><span class="dv">1</span>] <span class="cf">if</span> root <span class="op">&gt;</span> i <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>                right_cost <span class="op">=</span> cost[root<span class="op">+</span><span class="dv">1</span>][j] <span class="cf">if</span> root <span class="op">&lt;</span> j <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>                total <span class="op">=</span> left_cost <span class="op">+</span> right_cost <span class="op">+</span> freq_sum</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>                cost[i][j] <span class="op">=</span> <span class="bu">min</span>(cost[i][j], total)</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cost[<span class="dv">0</span>][n<span class="op">-</span><span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="tree-dp" class="level4" data-number="6.7.1.2">
<h4 data-number="6.7.1.2" class="anchored" data-anchor-id="tree-dp"><span class="header-section-number">6.7.1.2</span> 2. <strong>Tree DP</strong></h4>
<p>Problems on tree structures using subtree solutions.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> maximum_independent_set_tree(tree, values):</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Find maximum sum of node values with no adjacent nodes selected.</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Pattern: For each node, consider include/exclude decisions.</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> dfs(node):</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Returns (max_with_node, max_without_node)</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> tree[node]:  <span class="co"># Leaf</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> (values[node], <span class="dv">0</span>)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>        with_node <span class="op">=</span> values[node]</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>        without_node <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> child <span class="kw">in</span> tree[node]:</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>            child_with, child_without <span class="op">=</span> dfs(child)</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>            with_node <span class="op">+=</span> child_without  <span class="co"># Can't include child</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>            without_node <span class="op">+=</span> <span class="bu">max</span>(child_with, child_without)</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (with_node, without_node)</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">max</span>(dfs(root))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="digit-dp" class="level4" data-number="6.7.1.3">
<h4 data-number="6.7.1.3" class="anchored" data-anchor-id="digit-dp"><span class="header-section-number">6.7.1.3</span> 3. <strong>Digit DP</strong></h4>
<p>Count numbers with specific properties in a range.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_numbers_with_sum(n, target_sum):</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Count numbers from 1 to n with digit sum = target_sum.</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Pattern: Build numbers digit by digit with constraints.</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    digits <span class="op">=</span> [<span class="bu">int</span>(d) <span class="cf">for</span> d <span class="kw">in</span> <span class="bu">str</span>(n)]</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    memo <span class="op">=</span> {}</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> dp(pos, sum_so_far, tight):</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># pos: current digit position</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># sum_so_far: sum of digits chosen</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># tight: whether we're still bounded by n</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> pos <span class="op">==</span> <span class="bu">len</span>(digits):</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">1</span> <span class="cf">if</span> sum_so_far <span class="op">==</span> target_sum <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (pos, sum_so_far, tight) <span class="kw">in</span> memo:</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> memo[(pos, sum_so_far, tight)]</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>        limit <span class="op">=</span> digits[pos] <span class="cf">if</span> tight <span class="cf">else</span> <span class="dv">9</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> digit <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, limit <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> sum_so_far <span class="op">+</span> digit <span class="op">&lt;=</span> target_sum:</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>                result <span class="op">+=</span> dp(pos <span class="op">+</span> <span class="dv">1</span>, sum_so_far <span class="op">+</span> digit,</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>                           tight <span class="kw">and</span> digit <span class="op">==</span> limit)</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>        memo[(pos, sum_so_far, tight)] <span class="op">=</span> result</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> result</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dp(<span class="dv">0</span>, <span class="dv">0</span>, <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="space-optimization-techniques" class="level3" data-number="6.7.2">
<h3 data-number="6.7.2" class="anchored" data-anchor-id="space-optimization-techniques"><span class="header-section-number">6.7.2</span> Space Optimization Techniques</h3>
<section id="rolling-array" class="level4" data-number="6.7.2.1">
<h4 data-number="6.7.2.1" class="anchored" data-anchor-id="rolling-array"><span class="header-section-number">6.7.2.1</span> 1. <strong>Rolling Array</strong></h4>
<p>When you only need k previous rows/states.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fibonacci_constant_space(n):</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""O(1) space Fibonacci using only last 2 values."""</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">&lt;=</span> <span class="dv">1</span>:</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> n</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    prev2, prev1 <span class="op">=</span> <span class="dv">0</span>, <span class="dv">1</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>        curr <span class="op">=</span> prev1 <span class="op">+</span> prev2</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>        prev2, prev1 <span class="op">=</span> prev1, curr</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prev1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="state-compression" class="level4" data-number="6.7.2.2">
<h4 data-number="6.7.2.2" class="anchored" data-anchor-id="state-compression"><span class="header-section-number">6.7.2.2</span> 2. <strong>State Compression</strong></h4>
<p>Use bitmasks to represent states compactly.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> traveling_salesman_dp(distances):</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co">    TSP using DP with bitmask for visited cities.</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Time: O(n² × 2ⁿ)</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Space: O(n × 2ⁿ)</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(distances)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># dp[mask][i] = min cost to visit cities in mask, ending at i</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>    dp <span class="op">=</span> [[<span class="bu">float</span>(<span class="st">'inf'</span>)] <span class="op">*</span> n <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span> <span class="op">&lt;&lt;</span> n)]</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Start from city 0</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>    dp[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mask <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span> <span class="op">&lt;&lt;</span> n):</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> last <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> (mask <span class="op">&amp;</span> (<span class="dv">1</span> <span class="op">&lt;&lt;</span> last)):</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> dp[mask][last] <span class="op">==</span> <span class="bu">float</span>(<span class="st">'inf'</span>):</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> next_city <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> mask <span class="op">&amp;</span> (<span class="dv">1</span> <span class="op">&lt;&lt;</span> next_city):</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>                new_mask <span class="op">=</span> mask <span class="op">|</span> (<span class="dv">1</span> <span class="op">&lt;&lt;</span> next_city)</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>                dp[new_mask][next_city] <span class="op">=</span> <span class="bu">min</span>(</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>                    dp[new_mask][next_city],</span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>                    dp[mask][last] <span class="op">+</span> distances[last][next_city]</span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return to start</span></span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> <span class="bu">float</span>(<span class="st">'inf'</span>)</span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>    final_mask <span class="op">=</span> (<span class="dv">1</span> <span class="op">&lt;&lt;</span> n) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> last <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n):</span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="bu">min</span>(result, dp[final_mask][last] <span class="op">+</span> distances[last][<span class="dv">0</span>])</span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="divide-and-conquer-optimization" class="level4" data-number="6.7.2.3">
<h4 data-number="6.7.2.3" class="anchored" data-anchor-id="divide-and-conquer-optimization"><span class="header-section-number">6.7.2.3</span> 3. <strong>Divide and Conquer Optimization</strong></h4>
<p>For certain DP recurrences with monotonicity properties.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convex_hull_trick_dp(costs):</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Optimize DP transitions using convex hull trick.</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Useful when dp[i] = min(dp[j] + cost(j, i)) with special structure.</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Implementation depends on specific cost function</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="dp-optimization-checklist" class="level3" data-number="6.7.3">
<h3 data-number="6.7.3" class="anchored" data-anchor-id="dp-optimization-checklist"><span class="header-section-number">6.7.3</span> DP Optimization Checklist</h3>
<ol type="1">
<li><p><strong>Can you reduce dimensions?</strong></p>
<ul>
<li>Sometimes you don’t need the full table</li>
<li>Example: LCS only needs 2 rows</li>
</ul></li>
<li><p><strong>Can you use monotonicity?</strong></p>
<ul>
<li>Binary search on optimal split point</li>
<li>Convex hull trick for linear functions</li>
</ul></li>
<li><p><strong>Can you prune states?</strong></p>
<ul>
<li>Skip impossible states</li>
<li>Use bounds to eliminate branches</li>
</ul></li>
<li><p><strong>Can you change the recurrence?</strong></p>
<ul>
<li>Sometimes reformulating gives better complexity</li>
<li>Example: Push DP vs Pull DP</li>
</ul></li>
</ol>
<hr>
</section>
</section>
<section id="section-5.6-project---dynamic-programming-library" class="level2" data-number="6.8">
<h2 data-number="6.8" class="anchored" data-anchor-id="section-5.6-project---dynamic-programming-library"><span class="header-section-number">6.8</span> Section 5.6: Project - Dynamic Programming Library</h2>
<section id="project-overview" class="level3" data-number="6.8.1">
<h3 data-number="6.8.1" class="anchored" data-anchor-id="project-overview"><span class="header-section-number">6.8.1</span> Project Overview</h3>
<p>Building on our algorithm toolkit from Chapters 1-2, we’ll create a comprehensive DP library with visualization and benchmarking.</p>
</section>
<section id="project-structure" class="level3" data-number="6.8.2">
<h3 data-number="6.8.2" class="anchored" data-anchor-id="project-structure"><span class="header-section-number">6.8.2</span> Project Structure</h3>
<pre><code>algorithms_project/
├── src/
│   ├── dynamic_programming/
│   │   ├── __init__.py
│   │   ├── classical/
│   │   │   ├── fibonacci.py
│   │   │   ├── knapsack.py
│   │   │   ├── lcs.py
│   │   │   ├── edit_distance.py
│   │   │   └── matrix_chain.py
│   │   ├── optimization/
│   │   │   ├── space_optimizer.py
│   │   │   └── state_compression.py
│   │   └── visualization/
│   │       ├── dp_table_viz.py
│   │       └── recursion_tree.py
│   ├── benchmarking/           # From Chapter 1
│   └── divide_conquer/         # From Chapter 2
├── tests/
│   └── test_dynamic_programming/
│       ├── test_correctness.py
│       ├── test_optimization.py
│       └── test_edge_cases.py
├── examples/
│   ├── bioinformatics_alignment.py
│   ├── text_diff_tool.py
│   └── resource_allocation.py
└── notebooks/
    └── dp_analysis.ipynb</code></pre>
</section>
<section id="core-implementation-dp-base-class" class="level3" data-number="6.8.3">
<h3 data-number="6.8.3" class="anchored" data-anchor-id="core-implementation-dp-base-class"><span class="header-section-number">6.8.3</span> Core Implementation: DP Base Class</h3>
<div class="sourceCode" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># src/dynamic_programming/base.py</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> abc <span class="im">import</span> ABC, abstractmethod</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Any, Dict, List, Optional, Tuple</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tracemalloc</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> wraps</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> DPProblem(ABC):</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="co">    Abstract base class for dynamic programming problems.</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="co">    Provides common functionality for memoization, tabulation, and analysis.</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, name: <span class="bu">str</span> <span class="op">=</span> <span class="st">"Unnamed DP Problem"</span>):</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.name <span class="op">=</span> name</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.call_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.memo <span class="op">=</span> {}</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.execution_stats <span class="op">=</span> {}</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">@abstractmethod</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> define_subproblem(<span class="va">self</span>, <span class="op">*</span>args) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a><span class="co">        Define what the subproblem represents.</span></span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns a string description for documentation.</span></span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">@abstractmethod</span></span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> base_cases(<span class="va">self</span>, <span class="op">*</span>args) <span class="op">-&gt;</span> Optional[Any]:</span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a><span class="co">        Check and return base case values.</span></span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns None if not a base case.</span></span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">@abstractmethod</span></span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> recurrence(<span class="va">self</span>, <span class="op">*</span>args) <span class="op">-&gt;</span> Any:</span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a><span class="co">        Define the recurrence relation.</span></span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a><span class="co">        This should make recursive calls to solve_memoized.</span></span>
<span id="cb37-42"><a href="#cb37-42" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb37-43"><a href="#cb37-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb37-44"><a href="#cb37-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-45"><a href="#cb37-45" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> solve_memoized(<span class="va">self</span>, <span class="op">*</span>args) <span class="op">-&gt;</span> Any:</span>
<span id="cb37-46"><a href="#cb37-46" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb37-47"><a href="#cb37-47" aria-hidden="true" tabindex="-1"></a><span class="co">        Solve using top-down memoization.</span></span>
<span id="cb37-48"><a href="#cb37-48" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb37-49"><a href="#cb37-49" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.call_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb37-50"><a href="#cb37-50" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb37-51"><a href="#cb37-51" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Check base cases</span></span>
<span id="cb37-52"><a href="#cb37-52" aria-hidden="true" tabindex="-1"></a>        base_result <span class="op">=</span> <span class="va">self</span>.base_cases(<span class="op">*</span>args)</span>
<span id="cb37-53"><a href="#cb37-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> base_result <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb37-54"><a href="#cb37-54" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> base_result</span>
<span id="cb37-55"><a href="#cb37-55" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb37-56"><a href="#cb37-56" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Check memo</span></span>
<span id="cb37-57"><a href="#cb37-57" aria-hidden="true" tabindex="-1"></a>        key <span class="op">=</span> args</span>
<span id="cb37-58"><a href="#cb37-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> key <span class="kw">in</span> <span class="va">self</span>.memo:</span>
<span id="cb37-59"><a href="#cb37-59" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">self</span>.memo[key]</span>
<span id="cb37-60"><a href="#cb37-60" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb37-61"><a href="#cb37-61" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Compute and memoize</span></span>
<span id="cb37-62"><a href="#cb37-62" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="va">self</span>.recurrence(<span class="op">*</span>args)</span>
<span id="cb37-63"><a href="#cb37-63" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.memo[key] <span class="op">=</span> result</span>
<span id="cb37-64"><a href="#cb37-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> result</span>
<span id="cb37-65"><a href="#cb37-65" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-66"><a href="#cb37-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">@abstractmethod</span></span>
<span id="cb37-67"><a href="#cb37-67" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> solve_tabulation(<span class="va">self</span>, <span class="op">*</span>args) <span class="op">-&gt;</span> Any:</span>
<span id="cb37-68"><a href="#cb37-68" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb37-69"><a href="#cb37-69" aria-hidden="true" tabindex="-1"></a><span class="co">        Solve using bottom-up tabulation.</span></span>
<span id="cb37-70"><a href="#cb37-70" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb37-71"><a href="#cb37-71" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb37-72"><a href="#cb37-72" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-73"><a href="#cb37-73" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> solve_space_optimized(<span class="va">self</span>, <span class="op">*</span>args) <span class="op">-&gt;</span> Any:</span>
<span id="cb37-74"><a href="#cb37-74" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb37-75"><a href="#cb37-75" aria-hidden="true" tabindex="-1"></a><span class="co">        Space-optimized solution (if applicable).</span></span>
<span id="cb37-76"><a href="#cb37-76" aria-hidden="true" tabindex="-1"></a><span class="co">        Default implementation calls tabulation.</span></span>
<span id="cb37-77"><a href="#cb37-77" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb37-78"><a href="#cb37-78" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.solve_tabulation(<span class="op">*</span>args)</span>
<span id="cb37-79"><a href="#cb37-79" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-80"><a href="#cb37-80" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> benchmark(<span class="va">self</span>, <span class="op">*</span>args, methods<span class="op">=</span>[<span class="st">'memoized'</span>, <span class="st">'tabulation'</span>, <span class="st">'space_optimized'</span>]) <span class="op">-&gt;</span> Dict:</span>
<span id="cb37-81"><a href="#cb37-81" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb37-82"><a href="#cb37-82" aria-hidden="true" tabindex="-1"></a><span class="co">        Benchmark different solution methods.</span></span>
<span id="cb37-83"><a href="#cb37-83" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb37-84"><a href="#cb37-84" aria-hidden="true" tabindex="-1"></a>        results <span class="op">=</span> {}</span>
<span id="cb37-85"><a href="#cb37-85" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb37-86"><a href="#cb37-86" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> method <span class="kw">in</span> methods:</span>
<span id="cb37-87"><a href="#cb37-87" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> method <span class="op">==</span> <span class="st">'memoized'</span>:</span>
<span id="cb37-88"><a href="#cb37-88" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.memo.clear()</span>
<span id="cb37-89"><a href="#cb37-89" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.call_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb37-90"><a href="#cb37-90" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb37-91"><a href="#cb37-91" aria-hidden="true" tabindex="-1"></a>                tracemalloc.start()</span>
<span id="cb37-92"><a href="#cb37-92" aria-hidden="true" tabindex="-1"></a>                start_time <span class="op">=</span> time.perf_counter()</span>
<span id="cb37-93"><a href="#cb37-93" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb37-94"><a href="#cb37-94" aria-hidden="true" tabindex="-1"></a>                result <span class="op">=</span> <span class="va">self</span>.solve_memoized(<span class="op">*</span>args)</span>
<span id="cb37-95"><a href="#cb37-95" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb37-96"><a href="#cb37-96" aria-hidden="true" tabindex="-1"></a>                end_time <span class="op">=</span> time.perf_counter()</span>
<span id="cb37-97"><a href="#cb37-97" aria-hidden="true" tabindex="-1"></a>                current, peak <span class="op">=</span> tracemalloc.get_traced_memory()</span>
<span id="cb37-98"><a href="#cb37-98" aria-hidden="true" tabindex="-1"></a>                tracemalloc.stop()</span>
<span id="cb37-99"><a href="#cb37-99" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb37-100"><a href="#cb37-100" aria-hidden="true" tabindex="-1"></a>                results[method] <span class="op">=</span> {</span>
<span id="cb37-101"><a href="#cb37-101" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'result'</span>: result,</span>
<span id="cb37-102"><a href="#cb37-102" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'time'</span>: end_time <span class="op">-</span> start_time,</span>
<span id="cb37-103"><a href="#cb37-103" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'memory_peak'</span>: peak <span class="op">/</span> <span class="dv">1024</span> <span class="op">/</span> <span class="dv">1024</span>,  <span class="co"># MB</span></span>
<span id="cb37-104"><a href="#cb37-104" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'function_calls'</span>: <span class="va">self</span>.call_count</span>
<span id="cb37-105"><a href="#cb37-105" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb37-106"><a href="#cb37-106" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb37-107"><a href="#cb37-107" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> method <span class="op">==</span> <span class="st">'tabulation'</span>:</span>
<span id="cb37-108"><a href="#cb37-108" aria-hidden="true" tabindex="-1"></a>                tracemalloc.start()</span>
<span id="cb37-109"><a href="#cb37-109" aria-hidden="true" tabindex="-1"></a>                start_time <span class="op">=</span> time.perf_counter()</span>
<span id="cb37-110"><a href="#cb37-110" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb37-111"><a href="#cb37-111" aria-hidden="true" tabindex="-1"></a>                result <span class="op">=</span> <span class="va">self</span>.solve_tabulation(<span class="op">*</span>args)</span>
<span id="cb37-112"><a href="#cb37-112" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb37-113"><a href="#cb37-113" aria-hidden="true" tabindex="-1"></a>                end_time <span class="op">=</span> time.perf_counter()</span>
<span id="cb37-114"><a href="#cb37-114" aria-hidden="true" tabindex="-1"></a>                current, peak <span class="op">=</span> tracemalloc.get_traced_memory()</span>
<span id="cb37-115"><a href="#cb37-115" aria-hidden="true" tabindex="-1"></a>                tracemalloc.stop()</span>
<span id="cb37-116"><a href="#cb37-116" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb37-117"><a href="#cb37-117" aria-hidden="true" tabindex="-1"></a>                results[method] <span class="op">=</span> {</span>
<span id="cb37-118"><a href="#cb37-118" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'result'</span>: result,</span>
<span id="cb37-119"><a href="#cb37-119" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'time'</span>: end_time <span class="op">-</span> start_time,</span>
<span id="cb37-120"><a href="#cb37-120" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'memory_peak'</span>: peak <span class="op">/</span> <span class="dv">1024</span> <span class="op">/</span> <span class="dv">1024</span>  <span class="co"># MB</span></span>
<span id="cb37-121"><a href="#cb37-121" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb37-122"><a href="#cb37-122" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb37-123"><a href="#cb37-123" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> method <span class="op">==</span> <span class="st">'space_optimized'</span>:</span>
<span id="cb37-124"><a href="#cb37-124" aria-hidden="true" tabindex="-1"></a>                tracemalloc.start()</span>
<span id="cb37-125"><a href="#cb37-125" aria-hidden="true" tabindex="-1"></a>                start_time <span class="op">=</span> time.perf_counter()</span>
<span id="cb37-126"><a href="#cb37-126" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb37-127"><a href="#cb37-127" aria-hidden="true" tabindex="-1"></a>                result <span class="op">=</span> <span class="va">self</span>.solve_space_optimized(<span class="op">*</span>args)</span>
<span id="cb37-128"><a href="#cb37-128" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb37-129"><a href="#cb37-129" aria-hidden="true" tabindex="-1"></a>                end_time <span class="op">=</span> time.perf_counter()</span>
<span id="cb37-130"><a href="#cb37-130" aria-hidden="true" tabindex="-1"></a>                current, peak <span class="op">=</span> tracemalloc.get_traced_memory()</span>
<span id="cb37-131"><a href="#cb37-131" aria-hidden="true" tabindex="-1"></a>                tracemalloc.stop()</span>
<span id="cb37-132"><a href="#cb37-132" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb37-133"><a href="#cb37-133" aria-hidden="true" tabindex="-1"></a>                results[method] <span class="op">=</span> {</span>
<span id="cb37-134"><a href="#cb37-134" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'result'</span>: result,</span>
<span id="cb37-135"><a href="#cb37-135" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'time'</span>: end_time <span class="op">-</span> start_time,</span>
<span id="cb37-136"><a href="#cb37-136" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'memory_peak'</span>: peak <span class="op">/</span> <span class="dv">1024</span> <span class="op">/</span> <span class="dv">1024</span>  <span class="co"># MB</span></span>
<span id="cb37-137"><a href="#cb37-137" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb37-138"><a href="#cb37-138" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb37-139"><a href="#cb37-139" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.execution_stats <span class="op">=</span> results</span>
<span id="cb37-140"><a href="#cb37-140" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> results</span>
<span id="cb37-141"><a href="#cb37-141" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-142"><a href="#cb37-142" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> visualize_recursion_tree(<span class="va">self</span>, <span class="op">*</span>args, max_depth: <span class="bu">int</span> <span class="op">=</span> <span class="dv">5</span>):</span>
<span id="cb37-143"><a href="#cb37-143" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb37-144"><a href="#cb37-144" aria-hidden="true" tabindex="-1"></a><span class="co">        Generate a visualization of the recursion tree.</span></span>
<span id="cb37-145"><a href="#cb37-145" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb37-146"><a href="#cb37-146" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Implementation would generate graphviz or matplotlib visualization</span></span>
<span id="cb37-147"><a href="#cb37-147" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb37-148"><a href="#cb37-148" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-149"><a href="#cb37-149" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> visualize_dp_table(<span class="va">self</span>, <span class="op">*</span>args):</span>
<span id="cb37-150"><a href="#cb37-150" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb37-151"><a href="#cb37-151" aria-hidden="true" tabindex="-1"></a><span class="co">        Visualize the DP table construction.</span></span>
<span id="cb37-152"><a href="#cb37-152" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb37-153"><a href="#cb37-153" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Implementation would show table filling animation</span></span>
<span id="cb37-154"><a href="#cb37-154" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="example-knapsack-implementation" class="level3" data-number="6.8.4">
<h3 data-number="6.8.4" class="anchored" data-anchor-id="example-knapsack-implementation"><span class="header-section-number">6.8.4</span> Example: Knapsack Implementation</h3>
<div class="sourceCode" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># src/dynamic_programming/classical/knapsack.py</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> ..base <span class="im">import</span> DPProblem</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Optional</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Knapsack01(DPProblem):</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="co">    0/1 Knapsack Problem Implementation.</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, weights: List[<span class="bu">int</span>], values: List[<span class="bu">int</span>], capacity: <span class="bu">int</span>):</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>(<span class="st">"0/1 Knapsack"</span>)</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.weights <span class="op">=</span> weights</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.values <span class="op">=</span> values</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.capacity <span class="op">=</span> capacity</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.n <span class="op">=</span> <span class="bu">len</span>(weights)</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> define_subproblem(<span class="va">self</span>, i: <span class="bu">int</span>, w: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f"Maximum value using items 0..</span><span class="sc">{</span>i<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss"> with capacity </span><span class="sc">{</span>w<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> base_cases(<span class="va">self</span>, i: <span class="bu">int</span>, w: <span class="bu">int</span>) <span class="op">-&gt;</span> Optional[<span class="bu">int</span>]:</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> i <span class="op">==</span> <span class="dv">0</span> <span class="kw">or</span> w <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> recurrence(<span class="va">self</span>, i: <span class="bu">int</span>, w: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Can't include item i-1 if it's too heavy</span></span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.weights[i<span class="op">-</span><span class="dv">1</span>] <span class="op">&gt;</span> w:</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">self</span>.solve_memoized(i<span class="op">-</span><span class="dv">1</span>, w)</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Max of excluding or including item i-1</span></span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">max</span>(</span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.solve_memoized(i<span class="op">-</span><span class="dv">1</span>, w),  <span class="co"># Exclude</span></span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.solve_memoized(i<span class="op">-</span><span class="dv">1</span>, w <span class="op">-</span> <span class="va">self</span>.weights[i<span class="op">-</span><span class="dv">1</span>]) <span class="op">+</span> <span class="va">self</span>.values[i<span class="op">-</span><span class="dv">1</span>]  <span class="co"># Include</span></span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> solve_tabulation(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a><span class="co">        Bottom-up tabulation approach.</span></span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>        dp <span class="op">=</span> [[<span class="dv">0</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>.capacity <span class="op">+</span> <span class="dv">1</span>)] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>.n <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="va">self</span>.n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> w <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="va">self</span>.capacity <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="va">self</span>.weights[i<span class="op">-</span><span class="dv">1</span>] <span class="op">&gt;</span> w:</span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a>                    dp[i][w] <span class="op">=</span> dp[i<span class="op">-</span><span class="dv">1</span>][w]</span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a>                    dp[i][w] <span class="op">=</span> <span class="bu">max</span>(</span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a>                        dp[i<span class="op">-</span><span class="dv">1</span>][w],</span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a>                        dp[i<span class="op">-</span><span class="dv">1</span>][w <span class="op">-</span> <span class="va">self</span>.weights[i<span class="op">-</span><span class="dv">1</span>]] <span class="op">+</span> <span class="va">self</span>.values[i<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a>                    )</span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb38-53"><a href="#cb38-53" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.dp_table <span class="op">=</span> dp  <span class="co"># Store for visualization</span></span>
<span id="cb38-54"><a href="#cb38-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> dp[<span class="va">self</span>.n][<span class="va">self</span>.capacity]</span>
<span id="cb38-55"><a href="#cb38-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-56"><a href="#cb38-56" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> solve_space_optimized(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb38-57"><a href="#cb38-57" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb38-58"><a href="#cb38-58" aria-hidden="true" tabindex="-1"></a><span class="co">        Space-optimized using single array.</span></span>
<span id="cb38-59"><a href="#cb38-59" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb38-60"><a href="#cb38-60" aria-hidden="true" tabindex="-1"></a>        dp <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> (<span class="va">self</span>.capacity <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb38-61"><a href="#cb38-61" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb38-62"><a href="#cb38-62" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>.n):</span>
<span id="cb38-63"><a href="#cb38-63" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Iterate backwards to avoid overwriting needed values</span></span>
<span id="cb38-64"><a href="#cb38-64" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> w <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>.capacity, <span class="va">self</span>.weights[i] <span class="op">-</span> <span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb38-65"><a href="#cb38-65" aria-hidden="true" tabindex="-1"></a>                dp[w] <span class="op">=</span> <span class="bu">max</span>(dp[w], dp[w <span class="op">-</span> <span class="va">self</span>.weights[i]] <span class="op">+</span> <span class="va">self</span>.values[i])</span>
<span id="cb38-66"><a href="#cb38-66" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb38-67"><a href="#cb38-67" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> dp[<span class="va">self</span>.capacity]</span>
<span id="cb38-68"><a href="#cb38-68" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-69"><a href="#cb38-69" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_selected_items(<span class="va">self</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb38-70"><a href="#cb38-70" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb38-71"><a href="#cb38-71" aria-hidden="true" tabindex="-1"></a><span class="co">        Backtrack to find which items were selected.</span></span>
<span id="cb38-72"><a href="#cb38-72" aria-hidden="true" tabindex="-1"></a><span class="co">        Must call solve_tabulation first.</span></span>
<span id="cb38-73"><a href="#cb38-73" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb38-74"><a href="#cb38-74" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="bu">hasattr</span>(<span class="va">self</span>, <span class="st">'dp_table'</span>):</span>
<span id="cb38-75"><a href="#cb38-75" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.solve_tabulation()</span>
<span id="cb38-76"><a href="#cb38-76" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb38-77"><a href="#cb38-77" aria-hidden="true" tabindex="-1"></a>        selected <span class="op">=</span> []</span>
<span id="cb38-78"><a href="#cb38-78" aria-hidden="true" tabindex="-1"></a>        i, w <span class="op">=</span> <span class="va">self</span>.n, <span class="va">self</span>.capacity</span>
<span id="cb38-79"><a href="#cb38-79" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb38-80"><a href="#cb38-80" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> i <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">and</span> w <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb38-81"><a href="#cb38-81" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.dp_table[i][w] <span class="op">!=</span> <span class="va">self</span>.dp_table[i<span class="op">-</span><span class="dv">1</span>][w]:</span>
<span id="cb38-82"><a href="#cb38-82" aria-hidden="true" tabindex="-1"></a>                selected.append(i<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb38-83"><a href="#cb38-83" aria-hidden="true" tabindex="-1"></a>                w <span class="op">-=</span> <span class="va">self</span>.weights[i<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb38-84"><a href="#cb38-84" aria-hidden="true" tabindex="-1"></a>            i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb38-85"><a href="#cb38-85" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb38-86"><a href="#cb38-86" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">sorted</span>(selected)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="visualization-component" class="level3" data-number="6.8.5">
<h3 data-number="6.8.5" class="anchored" data-anchor-id="visualization-component"><span class="header-section-number">6.8.5</span> Visualization Component</h3>
<div class="sourceCode" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># src/dynamic_programming/visualization/dp_table_viz.py</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.animation <span class="im">as</span> animation</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> DPTableVisualizer:</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Animate DP table construction for educational purposes.</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, rows: <span class="bu">int</span>, cols: <span class="bu">int</span>, title: <span class="bu">str</span> <span class="op">=</span> <span class="st">"DP Table"</span>):</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.rows <span class="op">=</span> rows</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.cols <span class="op">=</span> cols</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.title <span class="op">=</span> title</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.table <span class="op">=</span> np.zeros((rows, cols))</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.history <span class="op">=</span> []</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> update_cell(<span class="va">self</span>, i: <span class="bu">int</span>, j: <span class="bu">int</span>, value: <span class="bu">float</span>, </span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>                   dependencies: List[Tuple[<span class="bu">int</span>, <span class="bu">int</span>]] <span class="op">=</span> <span class="va">None</span>):</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a><span class="co">        Record a cell update with its dependencies.</span></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.history.append({</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>            <span class="st">'cell'</span>: (i, j),</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>            <span class="st">'value'</span>: value,</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>            <span class="st">'dependencies'</span>: dependencies <span class="kw">or</span> []</span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.table[i, j] <span class="op">=</span> value</span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> animate(<span class="va">self</span>, interval: <span class="bu">int</span> <span class="op">=</span> <span class="dv">500</span>):</span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a><span class="co">        Create animated visualization of table filling.</span></span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>        fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">8</span>))</span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create color map</span></span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a>        im <span class="op">=</span> ax.imshow(np.zeros((<span class="va">self</span>.rows, <span class="va">self</span>.cols)), </span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a>                      cmap<span class="op">=</span><span class="st">'YlOrRd'</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span>np.<span class="bu">max</span>(<span class="va">self</span>.table))</span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Add grid</span></span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a>        ax.set_xticks(np.arange(<span class="va">self</span>.cols))</span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a>        ax.set_yticks(np.arange(<span class="va">self</span>.rows))</span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a>        ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Add text annotations</span></span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a>        text_annotations <span class="op">=</span> []</span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>.rows):</span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true" tabindex="-1"></a>            row_texts <span class="op">=</span> []</span>
<span id="cb39-51"><a href="#cb39-51" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>.cols):</span>
<span id="cb39-52"><a href="#cb39-52" aria-hidden="true" tabindex="-1"></a>                text <span class="op">=</span> ax.text(j, i, <span class="st">''</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb39-53"><a href="#cb39-53" aria-hidden="true" tabindex="-1"></a>                row_texts.append(text)</span>
<span id="cb39-54"><a href="#cb39-54" aria-hidden="true" tabindex="-1"></a>            text_annotations.append(row_texts)</span>
<span id="cb39-55"><a href="#cb39-55" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb39-56"><a href="#cb39-56" aria-hidden="true" tabindex="-1"></a>        <span class="kw">def</span> update_frame(frame_num):</span>
<span id="cb39-57"><a href="#cb39-57" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> frame_num <span class="op">&gt;=</span> <span class="bu">len</span>(<span class="va">self</span>.history):</span>
<span id="cb39-58"><a href="#cb39-58" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb39-59"><a href="#cb39-59" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb39-60"><a href="#cb39-60" aria-hidden="true" tabindex="-1"></a>            step <span class="op">=</span> <span class="va">self</span>.history[frame_num]</span>
<span id="cb39-61"><a href="#cb39-61" aria-hidden="true" tabindex="-1"></a>            i, j <span class="op">=</span> step[<span class="st">'cell'</span>]</span>
<span id="cb39-62"><a href="#cb39-62" aria-hidden="true" tabindex="-1"></a>            value <span class="op">=</span> step[<span class="st">'value'</span>]</span>
<span id="cb39-63"><a href="#cb39-63" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb39-64"><a href="#cb39-64" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Update cell color</span></span>
<span id="cb39-65"><a href="#cb39-65" aria-hidden="true" tabindex="-1"></a>            current_data <span class="op">=</span> im.get_array()</span>
<span id="cb39-66"><a href="#cb39-66" aria-hidden="true" tabindex="-1"></a>            current_data[i, j] <span class="op">=</span> value</span>
<span id="cb39-67"><a href="#cb39-67" aria-hidden="true" tabindex="-1"></a>            im.set_array(current_data)</span>
<span id="cb39-68"><a href="#cb39-68" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb39-69"><a href="#cb39-69" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Update text</span></span>
<span id="cb39-70"><a href="#cb39-70" aria-hidden="true" tabindex="-1"></a>            text_annotations[i][j].set_text(<span class="ss">f'</span><span class="sc">{</span>value<span class="sc">:.0f}</span><span class="ss">'</span>)</span>
<span id="cb39-71"><a href="#cb39-71" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb39-72"><a href="#cb39-72" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Highlight dependencies</span></span>
<span id="cb39-73"><a href="#cb39-73" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> dep_i, dep_j <span class="kw">in</span> step[<span class="st">'dependencies'</span>]:</span>
<span id="cb39-74"><a href="#cb39-74" aria-hidden="true" tabindex="-1"></a>                text_annotations[dep_i][dep_j].set_color(<span class="st">'blue'</span>)</span>
<span id="cb39-75"><a href="#cb39-75" aria-hidden="true" tabindex="-1"></a>                text_annotations[dep_i][dep_j].set_weight(<span class="st">'bold'</span>)</span>
<span id="cb39-76"><a href="#cb39-76" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb39-77"><a href="#cb39-77" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Reset previous highlights</span></span>
<span id="cb39-78"><a href="#cb39-78" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> frame_num <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb39-79"><a href="#cb39-79" aria-hidden="true" tabindex="-1"></a>                prev_step <span class="op">=</span> <span class="va">self</span>.history[frame_num <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb39-80"><a href="#cb39-80" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> dep_i, dep_j <span class="kw">in</span> prev_step[<span class="st">'dependencies'</span>]:</span>
<span id="cb39-81"><a href="#cb39-81" aria-hidden="true" tabindex="-1"></a>                    text_annotations[dep_i][dep_j].set_color(<span class="st">'black'</span>)</span>
<span id="cb39-82"><a href="#cb39-82" aria-hidden="true" tabindex="-1"></a>                    text_annotations[dep_i][dep_j].set_weight(<span class="st">'normal'</span>)</span>
<span id="cb39-83"><a href="#cb39-83" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb39-84"><a href="#cb39-84" aria-hidden="true" tabindex="-1"></a>            ax.set_title(<span class="ss">f'</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>title<span class="sc">}</span><span class="ss"> - Step </span><span class="sc">{</span>frame_num <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">/</span><span class="sc">{</span><span class="bu">len</span>(<span class="va">self</span>.history)<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb39-85"><a href="#cb39-85" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb39-86"><a href="#cb39-86" aria-hidden="true" tabindex="-1"></a>        anim <span class="op">=</span> animation.FuncAnimation(</span>
<span id="cb39-87"><a href="#cb39-87" aria-hidden="true" tabindex="-1"></a>            fig, update_frame, frames<span class="op">=</span><span class="bu">len</span>(<span class="va">self</span>.history),</span>
<span id="cb39-88"><a href="#cb39-88" aria-hidden="true" tabindex="-1"></a>            interval<span class="op">=</span>interval, repeat<span class="op">=</span><span class="va">True</span></span>
<span id="cb39-89"><a href="#cb39-89" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb39-90"><a href="#cb39-90" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb39-91"><a href="#cb39-91" aria-hidden="true" tabindex="-1"></a>        plt.show()</span>
<span id="cb39-92"><a href="#cb39-92" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> anim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="real-world-example-dna-alignment-tool" class="level3" data-number="6.8.6">
<h3 data-number="6.8.6" class="anchored" data-anchor-id="real-world-example-dna-alignment-tool"><span class="header-section-number">6.8.6</span> Real-World Example: DNA Alignment Tool</h3>
<div class="sourceCode" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># examples/bioinformatics_alignment.py</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> src.dynamic_programming.classical.lcs <span class="im">import</span> LongestCommonSubsequence</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> src.dynamic_programming.classical.edit_distance <span class="im">import</span> EditDistance</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> DNAAlignmentTool:</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="co">    Simplified DNA sequence alignment using DP algorithms.</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, seq1: <span class="bu">str</span>, seq2: <span class="bu">str</span>):</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.seq1 <span class="op">=</span> seq1</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.seq2 <span class="op">=</span> seq2</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> global_alignment(<span class="va">self</span>, match_score: <span class="bu">int</span> <span class="op">=</span> <span class="dv">2</span>, </span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>                        mismatch_penalty: <span class="bu">int</span> <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>                        gap_penalty: <span class="bu">int</span> <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a><span class="co">        Needleman-Wunsch algorithm for global alignment.</span></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>        m, n <span class="op">=</span> <span class="bu">len</span>(<span class="va">self</span>.seq1), <span class="bu">len</span>(<span class="va">self</span>.seq2)</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Initialize DP table</span></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>        dp <span class="op">=</span> [[<span class="dv">0</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(n <span class="op">+</span> <span class="dv">1</span>)] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(m <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Initialize gaps</span></span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, m <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>            dp[i][<span class="dv">0</span>] <span class="op">=</span> i <span class="op">*</span> gap_penalty</span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>            dp[<span class="dv">0</span>][j] <span class="op">=</span> j <span class="op">*</span> gap_penalty</span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Fill table</span></span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, m <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a>                match <span class="op">=</span> dp[i<span class="op">-</span><span class="dv">1</span>][j<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> (match_score <span class="cf">if</span> <span class="va">self</span>.seq1[i<span class="op">-</span><span class="dv">1</span>] <span class="op">==</span> <span class="va">self</span>.seq2[j<span class="op">-</span><span class="dv">1</span>] </span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a>                                       <span class="cf">else</span> mismatch_penalty)</span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a>                delete <span class="op">=</span> dp[i<span class="op">-</span><span class="dv">1</span>][j] <span class="op">+</span> gap_penalty</span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a>                insert <span class="op">=</span> dp[i][j<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> gap_penalty</span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a>                dp[i][j] <span class="op">=</span> <span class="bu">max</span>(match, delete, insert)</span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-43"><a href="#cb40-43" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Backtrack for alignment</span></span>
<span id="cb40-44"><a href="#cb40-44" aria-hidden="true" tabindex="-1"></a>        aligned1, aligned2 <span class="op">=</span> [], []</span>
<span id="cb40-45"><a href="#cb40-45" aria-hidden="true" tabindex="-1"></a>        i, j <span class="op">=</span> m, n</span>
<span id="cb40-46"><a href="#cb40-46" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-47"><a href="#cb40-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> i <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">or</span> j <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb40-48"><a href="#cb40-48" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> i <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">and</span> j <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">and</span> dp[i][j] <span class="op">==</span> dp[i<span class="op">-</span><span class="dv">1</span>][j<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> (</span>
<span id="cb40-49"><a href="#cb40-49" aria-hidden="true" tabindex="-1"></a>                match_score <span class="cf">if</span> <span class="va">self</span>.seq1[i<span class="op">-</span><span class="dv">1</span>] <span class="op">==</span> <span class="va">self</span>.seq2[j<span class="op">-</span><span class="dv">1</span>] <span class="cf">else</span> mismatch_penalty):</span>
<span id="cb40-50"><a href="#cb40-50" aria-hidden="true" tabindex="-1"></a>                aligned1.append(<span class="va">self</span>.seq1[i<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb40-51"><a href="#cb40-51" aria-hidden="true" tabindex="-1"></a>                aligned2.append(<span class="va">self</span>.seq2[j<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb40-52"><a href="#cb40-52" aria-hidden="true" tabindex="-1"></a>                i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb40-53"><a href="#cb40-53" aria-hidden="true" tabindex="-1"></a>                j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb40-54"><a href="#cb40-54" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> i <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">and</span> dp[i][j] <span class="op">==</span> dp[i<span class="op">-</span><span class="dv">1</span>][j] <span class="op">+</span> gap_penalty:</span>
<span id="cb40-55"><a href="#cb40-55" aria-hidden="true" tabindex="-1"></a>                aligned1.append(<span class="va">self</span>.seq1[i<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb40-56"><a href="#cb40-56" aria-hidden="true" tabindex="-1"></a>                aligned2.append(<span class="st">'-'</span>)</span>
<span id="cb40-57"><a href="#cb40-57" aria-hidden="true" tabindex="-1"></a>                i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb40-58"><a href="#cb40-58" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb40-59"><a href="#cb40-59" aria-hidden="true" tabindex="-1"></a>                aligned1.append(<span class="st">'-'</span>)</span>
<span id="cb40-60"><a href="#cb40-60" aria-hidden="true" tabindex="-1"></a>                aligned2.append(<span class="va">self</span>.seq2[j<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb40-61"><a href="#cb40-61" aria-hidden="true" tabindex="-1"></a>                j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb40-62"><a href="#cb40-62" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-63"><a href="#cb40-63" aria-hidden="true" tabindex="-1"></a>        aligned1.reverse()</span>
<span id="cb40-64"><a href="#cb40-64" aria-hidden="true" tabindex="-1"></a>        aligned2.reverse()</span>
<span id="cb40-65"><a href="#cb40-65" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-66"><a href="#cb40-66" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> dp[m][n], <span class="st">''</span>.join(aligned1), <span class="st">''</span>.join(aligned2)</span>
<span id="cb40-67"><a href="#cb40-67" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-68"><a href="#cb40-68" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> visualize_alignment(<span class="va">self</span>, aligned1: <span class="bu">str</span>, aligned2: <span class="bu">str</span>):</span>
<span id="cb40-69"><a href="#cb40-69" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb40-70"><a href="#cb40-70" aria-hidden="true" tabindex="-1"></a><span class="co">        Visualize the alignment with colors for matches/mismatches.</span></span>
<span id="cb40-71"><a href="#cb40-71" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb40-72"><a href="#cb40-72" aria-hidden="true" tabindex="-1"></a>        fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="bu">max</span>(<span class="bu">len</span>(aligned1), <span class="dv">20</span>), <span class="dv">3</span>))</span>
<span id="cb40-73"><a href="#cb40-73" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-74"><a href="#cb40-74" aria-hidden="true" tabindex="-1"></a>        colors <span class="op">=</span> []</span>
<span id="cb40-75"><a href="#cb40-75" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> c1, c2 <span class="kw">in</span> <span class="bu">zip</span>(aligned1, aligned2):</span>
<span id="cb40-76"><a href="#cb40-76" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> c1 <span class="op">==</span> c2 <span class="kw">and</span> c1 <span class="op">!=</span> <span class="st">'-'</span>:</span>
<span id="cb40-77"><a href="#cb40-77" aria-hidden="true" tabindex="-1"></a>                colors.append(<span class="st">'green'</span>)  <span class="co"># Match</span></span>
<span id="cb40-78"><a href="#cb40-78" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> c1 <span class="op">==</span> <span class="st">'-'</span> <span class="kw">or</span> c2 <span class="op">==</span> <span class="st">'-'</span>:</span>
<span id="cb40-79"><a href="#cb40-79" aria-hidden="true" tabindex="-1"></a>                colors.append(<span class="st">'yellow'</span>)  <span class="co"># Gap</span></span>
<span id="cb40-80"><a href="#cb40-80" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb40-81"><a href="#cb40-81" aria-hidden="true" tabindex="-1"></a>                colors.append(<span class="st">'red'</span>)     <span class="co"># Mismatch</span></span>
<span id="cb40-82"><a href="#cb40-82" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-83"><a href="#cb40-83" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create visualization</span></span>
<span id="cb40-84"><a href="#cb40-84" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, (c1, c2, color) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">zip</span>(aligned1, aligned2, colors)):</span>
<span id="cb40-85"><a href="#cb40-85" aria-hidden="true" tabindex="-1"></a>            ax.text(i, <span class="dv">1</span>, c1, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>, </span>
<span id="cb40-86"><a href="#cb40-86" aria-hidden="true" tabindex="-1"></a>                   fontsize<span class="op">=</span><span class="dv">12</span>, color<span class="op">=</span><span class="st">'white'</span>,</span>
<span id="cb40-87"><a href="#cb40-87" aria-hidden="true" tabindex="-1"></a>                   bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'square'</span>, facecolor<span class="op">=</span>color))</span>
<span id="cb40-88"><a href="#cb40-88" aria-hidden="true" tabindex="-1"></a>            ax.text(i, <span class="dv">0</span>, c2, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>,</span>
<span id="cb40-89"><a href="#cb40-89" aria-hidden="true" tabindex="-1"></a>                   fontsize<span class="op">=</span><span class="dv">12</span>, color<span class="op">=</span><span class="st">'white'</span>,</span>
<span id="cb40-90"><a href="#cb40-90" aria-hidden="true" tabindex="-1"></a>                   bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'square'</span>, facecolor<span class="op">=</span>color))</span>
<span id="cb40-91"><a href="#cb40-91" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-92"><a href="#cb40-92" aria-hidden="true" tabindex="-1"></a>        ax.set_xlim(<span class="op">-</span><span class="fl">0.5</span>, <span class="bu">len</span>(aligned1) <span class="op">-</span> <span class="fl">0.5</span>)</span>
<span id="cb40-93"><a href="#cb40-93" aria-hidden="true" tabindex="-1"></a>        ax.set_ylim(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">1.5</span>)</span>
<span id="cb40-94"><a href="#cb40-94" aria-hidden="true" tabindex="-1"></a>        ax.axis(<span class="st">'off'</span>)</span>
<span id="cb40-95"><a href="#cb40-95" aria-hidden="true" tabindex="-1"></a>        ax.set_title(<span class="st">'DNA Sequence Alignment</span><span class="ch">\n</span><span class="st">Green=Match, Red=Mismatch, Yellow=Gap'</span>)</span>
<span id="cb40-96"><a href="#cb40-96" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-97"><a href="#cb40-97" aria-hidden="true" tabindex="-1"></a>        plt.tight_layout()</span>
<span id="cb40-98"><a href="#cb40-98" aria-hidden="true" tabindex="-1"></a>        plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="testing-suite" class="level3" data-number="6.8.7">
<h3 data-number="6.8.7" class="anchored" data-anchor-id="testing-suite"><span class="header-section-number">6.8.7</span> Testing Suite</h3>
<div class="sourceCode" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tests/test_dynamic_programming/test_correctness.py</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> unittest</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> src.dynamic_programming.classical.knapsack <span class="im">import</span> Knapsack01</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> src.dynamic_programming.classical.lcs <span class="im">import</span> LongestCommonSubsequence</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> src.dynamic_programming.classical.edit_distance <span class="im">import</span> EditDistance</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> TestDPCorrectness(unittest.TestCase):</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Comprehensive correctness tests for DP implementations.</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> test_knapsack_basic(<span class="va">self</span>):</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Test basic knapsack functionality."""</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>        weights <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>]</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>        values <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">7</span>]</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>        capacity <span class="op">=</span> <span class="dv">7</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>        knapsack <span class="op">=</span> Knapsack01(weights, values, capacity)</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Test all methods give same result</span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>        memo_result <span class="op">=</span> knapsack.solve_memoized(<span class="bu">len</span>(weights), capacity)</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>        tab_result <span class="op">=</span> knapsack.solve_tabulation()</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>        opt_result <span class="op">=</span> knapsack.solve_space_optimized()</span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.assertEqual(memo_result, <span class="dv">9</span>)</span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.assertEqual(tab_result, <span class="dv">9</span>)</span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.assertEqual(opt_result, <span class="dv">9</span>)</span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Test selected items</span></span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>        items <span class="op">=</span> knapsack.get_selected_items()</span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.assertEqual(<span class="bu">set</span>(items), {<span class="dv">1</span>, <span class="dv">2</span>})</span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> test_knapsack_edge_cases(<span class="va">self</span>):</span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Test edge cases."""</span></span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Empty knapsack</span></span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a>        knapsack <span class="op">=</span> Knapsack01([], [], <span class="dv">10</span>)</span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.assertEqual(knapsack.solve_tabulation(), <span class="dv">0</span>)</span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Zero capacity</span></span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a>        knapsack <span class="op">=</span> Knapsack01([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>], <span class="dv">0</span>)</span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.assertEqual(knapsack.solve_tabulation(), <span class="dv">0</span>)</span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb41-44"><a href="#cb41-44" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Items too heavy</span></span>
<span id="cb41-45"><a href="#cb41-45" aria-hidden="true" tabindex="-1"></a>        knapsack <span class="op">=</span> Knapsack01([<span class="dv">10</span>, <span class="dv">20</span>], [<span class="dv">100</span>, <span class="dv">200</span>], <span class="dv">5</span>)</span>
<span id="cb41-46"><a href="#cb41-46" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.assertEqual(knapsack.solve_tabulation(), <span class="dv">0</span>)</span>
<span id="cb41-47"><a href="#cb41-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-48"><a href="#cb41-48" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> test_lcs_correctness(<span class="va">self</span>):</span>
<span id="cb41-49"><a href="#cb41-49" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Test LCS implementation."""</span></span>
<span id="cb41-50"><a href="#cb41-50" aria-hidden="true" tabindex="-1"></a>        test_cases <span class="op">=</span> [</span>
<span id="cb41-51"><a href="#cb41-51" aria-hidden="true" tabindex="-1"></a>            (<span class="st">"ABCDGH"</span>, <span class="st">"AEDFHR"</span>, <span class="st">"ADH"</span>),</span>
<span id="cb41-52"><a href="#cb41-52" aria-hidden="true" tabindex="-1"></a>            (<span class="st">"AGGTAB"</span>, <span class="st">"GXTXAYB"</span>, <span class="st">"GTAB"</span>),</span>
<span id="cb41-53"><a href="#cb41-53" aria-hidden="true" tabindex="-1"></a>            (<span class="st">""</span>, <span class="st">"ABC"</span>, <span class="st">""</span>),</span>
<span id="cb41-54"><a href="#cb41-54" aria-hidden="true" tabindex="-1"></a>            (<span class="st">"ABC"</span>, <span class="st">"ABC"</span>, <span class="st">"ABC"</span>),</span>
<span id="cb41-55"><a href="#cb41-55" aria-hidden="true" tabindex="-1"></a>            (<span class="st">"ABC"</span>, <span class="st">"DEF"</span>, <span class="st">""</span>)</span>
<span id="cb41-56"><a href="#cb41-56" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb41-57"><a href="#cb41-57" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb41-58"><a href="#cb41-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> seq1, seq2, expected <span class="kw">in</span> test_cases:</span>
<span id="cb41-59"><a href="#cb41-59" aria-hidden="true" tabindex="-1"></a>            lcs <span class="op">=</span> LongestCommonSubsequence(seq1, seq2)</span>
<span id="cb41-60"><a href="#cb41-60" aria-hidden="true" tabindex="-1"></a>            result <span class="op">=</span> lcs.solve_tabulation()</span>
<span id="cb41-61"><a href="#cb41-61" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.assertEqual(<span class="bu">len</span>(result), <span class="bu">len</span>(expected),</span>
<span id="cb41-62"><a href="#cb41-62" aria-hidden="true" tabindex="-1"></a>                           <span class="ss">f"Failed for </span><span class="sc">{</span>seq1<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>seq2<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb41-63"><a href="#cb41-63" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-64"><a href="#cb41-64" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> test_edit_distance_correctness(<span class="va">self</span>):</span>
<span id="cb41-65"><a href="#cb41-65" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Test edit distance implementation."""</span></span>
<span id="cb41-66"><a href="#cb41-66" aria-hidden="true" tabindex="-1"></a>        test_cases <span class="op">=</span> [</span>
<span id="cb41-67"><a href="#cb41-67" aria-hidden="true" tabindex="-1"></a>            (<span class="st">"SATURDAY"</span>, <span class="st">"SUNDAY"</span>, <span class="dv">3</span>),</span>
<span id="cb41-68"><a href="#cb41-68" aria-hidden="true" tabindex="-1"></a>            (<span class="st">"kitten"</span>, <span class="st">"sitting"</span>, <span class="dv">3</span>),</span>
<span id="cb41-69"><a href="#cb41-69" aria-hidden="true" tabindex="-1"></a>            (<span class="st">""</span>, <span class="st">"abc"</span>, <span class="dv">3</span>),</span>
<span id="cb41-70"><a href="#cb41-70" aria-hidden="true" tabindex="-1"></a>            (<span class="st">"abc"</span>, <span class="st">""</span>, <span class="dv">3</span>),</span>
<span id="cb41-71"><a href="#cb41-71" aria-hidden="true" tabindex="-1"></a>            (<span class="st">"abc"</span>, <span class="st">"abc"</span>, <span class="dv">0</span>),</span>
<span id="cb41-72"><a href="#cb41-72" aria-hidden="true" tabindex="-1"></a>            (<span class="st">"abc"</span>, <span class="st">"def"</span>, <span class="dv">3</span>)</span>
<span id="cb41-73"><a href="#cb41-73" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb41-74"><a href="#cb41-74" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb41-75"><a href="#cb41-75" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> str1, str2, expected <span class="kw">in</span> test_cases:</span>
<span id="cb41-76"><a href="#cb41-76" aria-hidden="true" tabindex="-1"></a>            ed <span class="op">=</span> EditDistance(str1, str2)</span>
<span id="cb41-77"><a href="#cb41-77" aria-hidden="true" tabindex="-1"></a>            result <span class="op">=</span> ed.solve_tabulation()</span>
<span id="cb41-78"><a href="#cb41-78" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.assertEqual(result, expected,</span>
<span id="cb41-79"><a href="#cb41-79" aria-hidden="true" tabindex="-1"></a>                           <span class="ss">f"Failed for </span><span class="sc">{</span>str1<span class="sc">}</span><span class="ss"> -&gt; </span><span class="sc">{</span>str2<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb41-80"><a href="#cb41-80" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-81"><a href="#cb41-81" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> test_performance_comparison(<span class="va">self</span>):</span>
<span id="cb41-82"><a href="#cb41-82" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Compare performance of different approaches."""</span></span>
<span id="cb41-83"><a href="#cb41-83" aria-hidden="true" tabindex="-1"></a>        weights <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">21</span>))</span>
<span id="cb41-84"><a href="#cb41-84" aria-hidden="true" tabindex="-1"></a>        values <span class="op">=</span> [i <span class="op">*</span> <span class="dv">2</span> <span class="cf">for</span> i <span class="kw">in</span> weights]</span>
<span id="cb41-85"><a href="#cb41-85" aria-hidden="true" tabindex="-1"></a>        capacity <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb41-86"><a href="#cb41-86" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb41-87"><a href="#cb41-87" aria-hidden="true" tabindex="-1"></a>        knapsack <span class="op">=</span> Knapsack01(weights, values, capacity)</span>
<span id="cb41-88"><a href="#cb41-88" aria-hidden="true" tabindex="-1"></a>        results <span class="op">=</span> knapsack.benchmark(<span class="bu">len</span>(weights), capacity)</span>
<span id="cb41-89"><a href="#cb41-89" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb41-90"><a href="#cb41-90" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Verify all methods give same answer</span></span>
<span id="cb41-91"><a href="#cb41-91" aria-hidden="true" tabindex="-1"></a>        answers <span class="op">=</span> [results[method][<span class="st">'result'</span>] <span class="cf">for</span> method <span class="kw">in</span> results]</span>
<span id="cb41-92"><a href="#cb41-92" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.assertEqual(<span class="bu">len</span>(<span class="bu">set</span>(answers)), <span class="dv">1</span>, <span class="st">"Methods give different results!"</span>)</span>
<span id="cb41-93"><a href="#cb41-93" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb41-94"><a href="#cb41-94" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Verify memoization uses less calls than naive would</span></span>
<span id="cb41-95"><a href="#cb41-95" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.assertLess(results[<span class="st">'memoized'</span>][<span class="st">'function_calls'</span>], </span>
<span id="cb41-96"><a href="#cb41-96" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">2</span> <span class="op">**</span> <span class="bu">len</span>(weights),</span>
<span id="cb41-97"><a href="#cb41-97" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Memoization not reducing function calls"</span>)</span>
<span id="cb41-98"><a href="#cb41-98" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb41-99"><a href="#cb41-99" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Verify space optimization uses less memory</span></span>
<span id="cb41-100"><a href="#cb41-100" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.assertLess(results[<span class="st">'space_optimized'</span>][<span class="st">'memory_peak'</span>],</span>
<span id="cb41-101"><a href="#cb41-101" aria-hidden="true" tabindex="-1"></a>                       results[<span class="st">'tabulation'</span>][<span class="st">'memory_peak'</span>],</span>
<span id="cb41-102"><a href="#cb41-102" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Space optimization not working"</span>)</span>
<span id="cb41-103"><a href="#cb41-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-104"><a href="#cb41-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-105"><a href="#cb41-105" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">'__main__'</span>:</span>
<span id="cb41-106"><a href="#cb41-106" aria-hidden="true" tabindex="-1"></a>    unittest.main()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
</section>
<section id="chapter-5-exercises" class="level2" data-number="6.9">
<h2 data-number="6.9" class="anchored" data-anchor-id="chapter-5-exercises"><span class="header-section-number">6.9</span> Chapter 5 Exercises</h2>
<section id="theoretical-problems" class="level3" data-number="6.9.1">
<h3 data-number="6.9.1" class="anchored" data-anchor-id="theoretical-problems"><span class="header-section-number">6.9.1</span> Theoretical Problems</h3>
<p><strong>5.1 Recurrence Relations</strong> Derive the recurrence relation for the following problems: a) Counting paths in a grid with obstacles b) Maximum sum path in a triangle c) Optimal strategy for a coin game d) Palindrome partitioning</p>
<p><strong>5.2 Complexity Analysis</strong> For each problem, determine time and space complexity: a) Matrix chain multiplication with n matrices b) LCS of k sequences (not just 2) c) 0/1 knapsack with weight limit W and n items d) Edit distance with custom operation costs</p>
<p><strong>5.3 Proof of Correctness</strong> Prove that the knapsack DP solution is optimal by showing: a) The problem has optimal substructure, b) Subproblems overlap c) The recurrence correctly combines subproblem solutions</p>
</section>
<section id="programming-problems" class="level3" data-number="6.9.2">
<h3 data-number="6.9.2" class="anchored" data-anchor-id="programming-problems"><span class="header-section-number">6.9.2</span> Programming Problems</h3>
<p><strong>5.4 Subset Sum Variants</strong> Implement these variations:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> subset_sum_count(arr, target):</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Count number of subsets that sum to target."""</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> subset_sum_minimum_difference(arr):</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Partition array into two subsets with minimum difference."""</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> subset_sum_k_partitions(arr, k):</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Check if array can be partitioned into k equal sum subsets."""</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>5.5 String DP Problems</strong></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> longest_palindromic_subsequence(s):</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Find length of longest palindromic subsequence."""</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> word_break(s, word_dict):</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Check if s can be segmented into dictionary words."""</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> regular_expression_matching(text, pattern):</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Implement regex matching with . and * support."""</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>5.5 Advanced Knapsack Variants</strong></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> unbounded_knapsack(weights, values, capacity):</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Knapsack with unlimited copies of each item."""</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fractional_knapsack(weights, values, capacity):</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Can take fractions of items (greedy, not DP)."""</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> bounded_knapsack(weights, values, quantities, capacity):</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Each item has limited quantity available."""</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="implementation-challenges" class="level3" data-number="6.9.3">
<h3 data-number="6.9.3" class="anchored" data-anchor-id="implementation-challenges"><span class="header-section-number">6.9.3</span> Implementation Challenges</h3>
<p><strong>3.7 DP with Reconstruction</strong> Implement these with full solution reconstruction:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> matrix_chain_with_parenthesization(dimensions):</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Return both cost and parenthesization string."""</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> lcs_all_solutions(X, Y):</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Find all possible LCS sequences."""</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> knapsack_all_optimal_solutions(weights, values, capacity):</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Find all item combinations giving optimal value."""</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>3.8 Space-Optimized Implementations</strong> Optimize these to use O(n) space instead of O(n²):</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> palindrome_check_optimized(s):</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Check if string can be palindrome with k deletions."""</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> lcs_length_only(X, Y):</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""LCS using only O(min(m,n)) space."""</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>3.9 Real-World Application</strong> Build a complete application:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> TextDiffTool:</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Build a simplified diff tool using LCS.</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Should handle:</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="co">    - Line-by-line comparison</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="co">    - Generating unified diff format</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="co">    - Applying patches</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="co">    - Three-way merge</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="analysis-problems" class="level3" data-number="6.9.4">
<h3 data-number="6.9.4" class="anchored" data-anchor-id="analysis-problems"><span class="header-section-number">6.9.4</span> Analysis Problems</h3>
<p><strong>5.10 Comparative Analysis</strong> Create a detailed report comparing:</p>
<ul>
<li>Recursive vs Memoized vs Tabulated vs Space-Optimized</li>
<li>For problems: Fibonacci, Knapsack, LCS, Edit Distance</li>
<li>Metrics: Time, Space, Cache hits, Function calls</li>
<li>Visualizations: Performance graphs, memory usage</li>
</ul>
<p><strong>5.11 When DP Fails</strong> Identify why DP doesn’t work well for: a) Traveling Salesman Problem (still exponential) b) Longest Path in general graphs (NP-hard) c) 3-SAT problem d) Graph coloring</p>
<p>Explain what makes these fundamentally different from problems where DP excels.</p>
<hr>
</section>
</section>
<section id="chapter-5-summary" class="level2" data-number="6.10">
<h2 data-number="6.10" class="anchored" data-anchor-id="chapter-5-summary"><span class="header-section-number">6.10</span> Chapter 5 Summary</h2>
<section id="key-takeaways" class="level3" data-number="6.10.1">
<h3 data-number="6.10.1" class="anchored" data-anchor-id="key-takeaways"><span class="header-section-number">6.10.1</span> Key Takeaways</h3>
<ol type="1">
<li><p><strong>Pattern Recognition</strong>: DP applies when:</p>
<ul>
<li>Optimal substructure exists</li>
<li>Subproblems overlap</li>
<li>Decisions can be made independently</li>
</ul></li>
<li><p><strong>Two Approaches</strong>:</p>
<ul>
<li><strong>Top-Down (Memoization)</strong>: Natural recursive thinking</li>
<li><strong>Bottom-Up (Tabulation)</strong>: Better space control</li>
</ul></li>
<li><p><strong>Design Process</strong>:</p>
<ul>
<li>Define subproblems clearly</li>
<li>Find a recurrence relation</li>
<li>Identify base cases</li>
<li>Decide on memoization vs tabulation</li>
<li>Optimize space when possible</li>
</ul></li>
<li><p><strong>Common Patterns</strong>:</p>
<ul>
<li>Sequences (LCS, Edit Distance)</li>
<li>Optimization (Knapsack, Matrix Chain)</li>
<li>Counting (Paths, Subsets)</li>
<li>Games (Min-Max strategies)</li>
</ul></li>
<li><p><strong>Real-World Impact</strong>:</p>
<ul>
<li>Bioinformatics (sequence alignment)</li>
<li>Natural Language Processing (spell check)</li>
<li>Computer Graphics (seam carving)</li>
<li>Finance (portfolio optimization)</li>
<li>Networking (packet routing)</li>
</ul></li>
</ol>
</section>
<section id="whats-next" class="level3" data-number="6.10.2">
<h3 data-number="6.10.2" class="anchored" data-anchor-id="whats-next"><span class="header-section-number">6.10.2</span> What’s Next</h3>
<p>Chapter 4 will explore <strong>Greedy Algorithms</strong>, where we’ll learn when making locally optimal choices leads to global optimality. We’ll see how greedy differs from DP and when each approach is appropriate.</p>
<p>Then in Chapter 5, we’ll dive into <strong>Data Structures for Efficiency</strong>, building the specialized structures that make advanced algorithms possible—from heaps and balanced trees to advanced hashing techniques.</p>
</section>
<section id="final-thought" class="level3" data-number="6.10.3">
<h3 data-number="6.10.3" class="anchored" data-anchor-id="final-thought"><span class="header-section-number">6.10.3</span> Final Thought</h3>
<p>Dynamic Programming transforms the impossible into the tractable. By remembering our past computations, we avoid repeating work, turning exponential nightmares into polynomial solutions. This simple principle of <strong>memoization</strong> has revolutionized fields from biology to economics.</p>
<p>As computer scientist Richard Bellman (who coined “dynamic programming”) said: <em>“An optimal policy has the property that whatever the initial state and initial decision are, the remaining decisions must constitute an optimal policy with regard to the state resulting from the first decision.”</em></p>
<p>Master this principle, and you’ll see optimization problems in a completely new light.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../chapters/04-Greedy-Algorithms.html" class="pagination-link" aria-label="Chapter 4: Greedy Algorithms - When Local Optimality Leads to Global Solutions">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Chapter 4: Greedy Algorithms - When Local Optimality Leads to Global Solutions</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->




</body></html>