<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 650 400" width="650" height="400">
  <!-- Title -->
  <text x="325" y="25" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#1F2937">Observer Pattern</text>
  <text x="325" y="45" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#64748B">Define one-to-many dependency; when subject changes, observers are notified</text>
  
  <!-- Subject Interface -->
  <rect x="50" y="70" width="200" height="85" rx="0" fill="white" stroke="#3B82F6" stroke-width="2"/>
  <rect x="50" y="70" width="200" height="25" rx="0" fill="#DBEAFE"/>
  <text x="150" y="87" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#1E40AF" font-weight="bold">«interface» Subject</text>
  <line x1="50" y1="95" x2="250" y2="95" stroke="#3B82F6" stroke-width="1"/>
  <text x="60" y="113" text-anchor="start" font-family="Consolas, monospace" font-size="9" fill="#374151">+ attach(o: Observer)</text>
  <text x="60" y="128" text-anchor="start" font-family="Consolas, monospace" font-size="9" fill="#374151">+ detach(o: Observer)</text>
  <text x="60" y="143" text-anchor="start" font-family="Consolas, monospace" font-size="9" fill="#374151">+ notify(): void</text>
  
  <!-- Observer Interface -->
  <rect x="400" y="70" width="200" height="55" rx="0" fill="white" stroke="#10B981" stroke-width="2"/>
  <rect x="400" y="70" width="200" height="25" rx="0" fill="#D1FAE5"/>
  <text x="500" y="87" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#065F46" font-weight="bold">«interface» Observer</text>
  <line x1="400" y1="95" x2="600" y2="95" stroke="#10B981" stroke-width="1"/>
  <text x="410" y="115" text-anchor="start" font-family="Consolas, monospace" font-size="9" fill="#374151">+ update(state): void</text>
  
  <!-- Association line between Subject and Observer -->
  <line x1="250" y1="97" x2="400" y2="97" stroke="#64748B" stroke-width="1.5"/>
  <polygon points="400,97 393,93 393,101" fill="#64748B"/>
  <text x="325" y="90" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#64748B">observers *</text>
  
  <!-- Concrete Subject -->
  <rect x="50" y="195" width="200" height="85" rx="0" fill="white" stroke="#3B82F6" stroke-width="2"/>
  <rect x="50" y="195" width="200" height="25" rx="0" fill="#DBEAFE"/>
  <text x="150" y="212" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#1E40AF" font-weight="bold">NewsPublisher</text>
  <line x1="50" y1="220" x2="250" y2="220" stroke="#3B82F6" stroke-width="1"/>
  <text x="60" y="238" text-anchor="start" font-family="Consolas, monospace" font-size="9" fill="#374151">- observers: List</text>
  <text x="60" y="253" text-anchor="start" font-family="Consolas, monospace" font-size="9" fill="#374151">- news: String</text>
  <line x1="50" y1="260" x2="250" y2="260" stroke="#3B82F6" stroke-width="1"/>
  <text x="60" y="275" text-anchor="start" font-family="Consolas, monospace" font-size="9" fill="#374151">+ publishNews(news)</text>
  
  <!-- Inheritance arrow from ConcreteSubject to Subject -->
  <line x1="150" y1="155" x2="150" y2="195" stroke="#64748B" stroke-width="1.5"/>
  <polygon points="150,155 145,165 155,165" fill="white" stroke="#64748B" stroke-width="1.5"/>
  
  <!-- Concrete Observers -->
  <rect x="340" y="175" width="130" height="65" rx="0" fill="white" stroke="#F59E0B" stroke-width="2"/>
  <rect x="340" y="175" width="130" height="25" rx="0" fill="#FEF3C7"/>
  <text x="405" y="192" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#92400E" font-weight="bold">EmailSubscriber</text>
  <line x1="340" y1="200" x2="470" y2="200" stroke="#F59E0B" stroke-width="1"/>
  <text x="350" y="218" text-anchor="start" font-family="Consolas, monospace" font-size="8" fill="#374151">- email: String</text>
  <text x="350" y="233" text-anchor="start" font-family="Consolas, monospace" font-size="8" fill="#374151">+ update(state)</text>
  
  <rect x="480" y="175" width="130" height="65" rx="0" fill="white" stroke="#F59E0B" stroke-width="2"/>
  <rect x="480" y="175" width="130" height="25" rx="0" fill="#FEF3C7"/>
  <text x="545" y="192" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#92400E" font-weight="bold">SMSSubscriber</text>
  <line x1="480" y1="200" x2="610" y2="200" stroke="#F59E0B" stroke-width="1"/>
  <text x="490" y="218" text-anchor="start" font-family="Consolas, monospace" font-size="8" fill="#374151">- phone: String</text>
  <text x="490" y="233" text-anchor="start" font-family="Consolas, monospace" font-size="8" fill="#374151">+ update(state)</text>
  
  <!-- Inheritance arrows for observers -->
  <line x1="500" y1="125" x2="500" y2="145" stroke="#64748B" stroke-width="1.5"/>
  <line x1="405" y1="145" x2="545" y2="145" stroke="#64748B" stroke-width="1.5"/>
  <line x1="405" y1="145" x2="405" y2="175" stroke="#64748B" stroke-width="1.5"/>
  <line x1="545" y1="145" x2="545" y2="175" stroke="#64748B" stroke-width="1.5"/>
  <polygon points="500,125 495,135 505,135" fill="white" stroke="#64748B" stroke-width="1.5"/>
  
  <!-- Flow explanation -->
  <rect x="100" y="300" width="450" height="65" rx="8" fill="#F8FAFC" stroke="#E2E8F0" stroke-width="1"/>
  <text x="325" y="320" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#374151" font-weight="bold">Notification Flow</text>
  
  <circle cx="140" cy="345" r="12" fill="#3B82F6"/>
  <text x="140" y="349" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white" font-weight="bold">1</text>
  <text x="160" y="349" text-anchor="start" font-family="Arial, sans-serif" font-size="9" fill="#374151">State changes</text>
  
  <circle cx="280" cy="345" r="12" fill="#3B82F6"/>
  <text x="280" y="349" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white" font-weight="bold">2</text>
  <text x="300" y="349" text-anchor="start" font-family="Arial, sans-serif" font-size="9" fill="#374151">notify() called</text>
  
  <circle cx="420" cy="345" r="12" fill="#3B82F6"/>
  <text x="420" y="349" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white" font-weight="bold">3</text>
  <text x="440" y="349" text-anchor="start" font-family="Arial, sans-serif" font-size="9" fill="#374151">All update()</text>
  
  <!-- Caption -->
  <text x="325" y="390" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#9CA3AF">Figure 4.22: Observer Pattern - News Publisher/Subscriber Example</text>
</svg>
