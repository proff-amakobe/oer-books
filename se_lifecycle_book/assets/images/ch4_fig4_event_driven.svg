<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 700 400" width="700" height="400">
  <defs>
    <linearGradient id="producerGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#3B82F6;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#1D4ED8;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="busGrad4" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#8B5CF6;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#7C3AED;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="consumerGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#10B981;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#059669;stop-opacity:1" />
    </linearGradient>
  </defs>
  
  <!-- Title -->
  <text x="350" y="25" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#1F2937">Event-Driven Architecture</text>
  
  <!-- Event Producers -->
  <text x="100" y="60" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#64748B" font-weight="bold">Event Producers</text>
  
  <rect x="30" y="75" width="140" height="55" rx="6" fill="url(#producerGrad)"/>
  <text x="100" y="100" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white" font-weight="bold">Order Service</text>
  <text x="100" y="118" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#DBEAFE">OrderPlaced</text>
  
  <rect x="30" y="140" width="140" height="55" rx="6" fill="url(#producerGrad)"/>
  <text x="100" y="165" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white" font-weight="bold">User Service</text>
  <text x="100" y="183" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#DBEAFE">UserRegistered</text>
  
  <rect x="30" y="205" width="140" height="55" rx="6" fill="url(#producerGrad)"/>
  <text x="100" y="230" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white" font-weight="bold">Payment Service</text>
  <text x="100" y="248" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#DBEAFE">PaymentReceived</text>
  
  <!-- Event Bus / Message Queue -->
  <rect x="230" y="95" width="240" height="150" rx="8" fill="url(#busGrad4)"/>
  <text x="350" y="130" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" fill="white" font-weight="bold">Event Bus</text>
  <text x="350" y="150" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#E9D5FF">Message Queue / Stream</text>
  
  <!-- Events inside bus -->
  <rect x="250" y="165" width="80" height="25" rx="4" fill="white" fill-opacity="0.2"/>
  <text x="290" y="182" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="white">OrderPlaced</text>
  
  <rect x="340" y="165" width="80" height="25" rx="4" fill="white" fill-opacity="0.2"/>
  <text x="380" y="182" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="white">UserRegistered</text>
  
  <rect x="295" y="200" width="90" height="25" rx="4" fill="white" fill-opacity="0.2"/>
  <text x="340" y="217" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="white">PaymentReceived</text>
  
  <!-- Event Consumers -->
  <text x="600" y="60" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#64748B" font-weight="bold">Event Consumers</text>
  
  <rect x="530" y="75" width="140" height="55" rx="6" fill="url(#consumerGrad)"/>
  <text x="600" y="100" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white" font-weight="bold">Notification</text>
  <text x="600" y="118" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#D1FAE5">Send emails/SMS</text>
  
  <rect x="530" y="140" width="140" height="55" rx="6" fill="url(#consumerGrad)"/>
  <text x="600" y="165" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white" font-weight="bold">Inventory</text>
  <text x="600" y="183" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#D1FAE5">Update stock</text>
  
  <rect x="530" y="205" width="140" height="55" rx="6" fill="url(#consumerGrad)"/>
  <text x="600" y="230" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white" font-weight="bold">Analytics</text>
  <text x="600" y="248" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#D1FAE5">Track metrics</text>
  
  <!-- Arrows: Producers to Bus -->
  <line x1="170" y1="102" x2="230" y2="140" stroke="#64748B" stroke-width="2"/>
  <polygon points="230,140 222,138 225,145" fill="#64748B"/>
  
  <line x1="170" y1="167" x2="230" y2="167" stroke="#64748B" stroke-width="2"/>
  <polygon points="230,167 223,163 223,171" fill="#64748B"/>
  
  <line x1="170" y1="232" x2="230" y2="195" stroke="#64748B" stroke-width="2"/>
  <polygon points="230,195 222,191 225,199" fill="#64748B"/>
  
  <text x="200" y="125" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#64748B">publish</text>
  
  <!-- Arrows: Bus to Consumers -->
  <line x1="470" y1="140" x2="530" y2="102" stroke="#64748B" stroke-width="2"/>
  <polygon points="530,102 522,100 525,108" fill="#64748B"/>
  
  <line x1="470" y1="167" x2="530" y2="167" stroke="#64748B" stroke-width="2"/>
  <polygon points="530,167 523,163 523,171" fill="#64748B"/>
  
  <line x1="470" y1="195" x2="530" y2="232" stroke="#64748B" stroke-width="2"/>
  <polygon points="530,232 522,228 525,236" fill="#64748B"/>
  
  <text x="500" y="125" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#64748B">subscribe</text>
  
  <!-- Advantages Box -->
  <rect x="50" y="285" width="600" height="85" rx="8" fill="#F8FAFC" stroke="#E2E8F0" stroke-width="1"/>
  <text x="350" y="305" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#374151" font-weight="bold">Event-Driven Advantages</text>
  
  <circle cx="90" cy="330" r="4" fill="#8B5CF6"/>
  <text x="100" y="334" text-anchor="start" font-family="Arial, sans-serif" font-size="9" fill="#374151">Loose coupling</text>
  
  <circle cx="200" cy="330" r="4" fill="#8B5CF6"/>
  <text x="210" y="334" text-anchor="start" font-family="Arial, sans-serif" font-size="9" fill="#374151">Scalability</text>
  
  <circle cx="300" cy="330" r="4" fill="#8B5CF6"/>
  <text x="310" y="334" text-anchor="start" font-family="Arial, sans-serif" font-size="9" fill="#374151">Async processing</text>
  
  <circle cx="430" cy="330" r="4" fill="#8B5CF6"/>
  <text x="440" y="334" text-anchor="start" font-family="Arial, sans-serif" font-size="9" fill="#374151">Audit trail</text>
  
  <circle cx="530" cy="330" r="4" fill="#8B5CF6"/>
  <text x="540" y="334" text-anchor="start" font-family="Arial, sans-serif" font-size="9" fill="#374151">Easy to extend</text>
  
  <text x="350" y="358" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#64748B" font-style="italic">Producers don't know about consumers â€¢ New consumers can be added without changing producers</text>
  
  <!-- Caption -->
  <text x="350" y="390" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#9CA3AF">Figure 4.7: Event-Driven Architecture - Publish/Subscribe Pattern</text>
</svg>
