<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 700 480" width="700" height="480">
  <!-- Title -->
  <text x="350" y="25" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#1F2937">Sequence Diagram: User Login Process</text>
  
  <!-- Lifelines -->
  <!-- User -->
  <rect x="50" y="50" width="80" height="30" rx="4" fill="#FEE2E2" stroke="#EF4444" stroke-width="1.5"/>
  <text x="90" y="70" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#991B1B">:User</text>
  <line x1="90" y1="80" x2="90" y2="440" stroke="#EF4444" stroke-width="1.5" stroke-dasharray="5,3"/>
  
  <!-- LoginController -->
  <rect x="180" y="50" width="100" height="30" rx="4" fill="#DBEAFE" stroke="#3B82F6" stroke-width="1.5"/>
  <text x="230" y="70" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#1E40AF">:LoginController</text>
  <line x1="230" y1="80" x2="230" y2="440" stroke="#3B82F6" stroke-width="1.5" stroke-dasharray="5,3"/>
  
  <!-- AuthService -->
  <rect x="340" y="50" width="100" height="30" rx="4" fill="#D1FAE5" stroke="#10B981" stroke-width="1.5"/>
  <text x="390" y="70" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#065F46">:AuthService</text>
  <line x1="390" y1="80" x2="390" y2="440" stroke="#10B981" stroke-width="1.5" stroke-dasharray="5,3"/>
  
  <!-- Database -->
  <rect x="500" y="50" width="80" height="30" rx="4" fill="#FEF3C7" stroke="#F59E0B" stroke-width="1.5"/>
  <text x="540" y="70" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#92400E">:Database</text>
  <line x1="540" y1="80" x2="540" y2="440" stroke="#F59E0B" stroke-width="1.5" stroke-dasharray="5,3"/>
  
  <!-- Message 1: enterCredentials -->
  <line x1="90" y1="110" x2="225" y2="110" stroke="#1F2937" stroke-width="1.5"/>
  <polygon points="225,110 218,106 218,114" fill="#1F2937"/>
  <text x="157" y="105" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#374151">enterCredentials(user, pass)</text>
  
  <!-- Activation bar on LoginController -->
  <rect x="225" y="110" width="10" height="305" fill="#3B82F6"/>
  
  <!-- Message 2: authenticate -->
  <line x1="235" y1="130" x2="385" y2="130" stroke="#1F2937" stroke-width="1.5"/>
  <polygon points="385,130 378,126 378,134" fill="#1F2937"/>
  <text x="310" y="125" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#374151">authenticate(user, pass)</text>
  
  <!-- Activation bar on AuthService -->
  <rect x="385" y="130" width="10" height="230" fill="#10B981"/>
  
  <!-- Message 3: findUser -->
  <line x1="395" y1="155" x2="535" y2="155" stroke="#1F2937" stroke-width="1.5"/>
  <polygon points="535,155 528,151 528,159" fill="#1F2937"/>
  <text x="465" y="150" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#374151">findUser(username)</text>
  
  <!-- Activation bar on Database -->
  <rect x="535" y="155" width="10" height="35" fill="#F59E0B"/>
  
  <!-- Return: user -->
  <line x1="535" y1="185" x2="395" y2="185" stroke="#1F2937" stroke-width="1.5" stroke-dasharray="5,3"/>
  <polygon points="395,185 402,181 402,189" fill="#1F2937"/>
  <text x="465" y="198" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#64748B">user</text>
  
  <!-- Alt fragment -->
  <rect x="60" y="215" width="575" height="185" rx="0" fill="none" stroke="#6366F1" stroke-width="1.5"/>
  <rect x="60" y="215" width="30" height="18" rx="0" fill="#6366F1"/>
  <text x="75" y="228" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white" font-weight="bold">alt</text>
  <text x="95" y="238" text-anchor="start" font-family="Arial, sans-serif" font-size="9" fill="#6366F1">[user exists]</text>
  
  <!-- verifyPassword (self-call) -->
  <path d="M395 260 L430 260 L430 285 L400 285" stroke="#1F2937" stroke-width="1.5" fill="none"/>
  <polygon points="400,285 407,281 407,289" fill="#1F2937"/>
  <text x="435" y="275" text-anchor="start" font-family="Arial, sans-serif" font-size="8" fill="#374151">verifyPassword()</text>
  
  <!-- Nested alt for password -->
  <rect x="100" y="300" width="520" height="85" rx="0" fill="none" stroke="#8B5CF6" stroke-width="1"/>
  <rect x="100" y="300" width="30" height="15" rx="0" fill="#8B5CF6"/>
  <text x="115" y="311" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="white" font-weight="bold">alt</text>
  <text x="135" y="320" text-anchor="start" font-family="Arial, sans-serif" font-size="8" fill="#8B5CF6">[valid]</text>
  
  <!-- createSession -->
  <path d="M395 330 L430 330 L430 345 L400 345" stroke="#1F2937" stroke-width="1.5" fill="none"/>
  <polygon points="400,345 407,341 407,349" fill="#1F2937"/>
  <text x="435" y="340" text-anchor="start" font-family="Arial, sans-serif" font-size="8" fill="#374151">createSession()</text>
  
  <!-- Return: token -->
  <line x1="385" y1="355" x2="235" y2="355" stroke="#1F2937" stroke-width="1.5" stroke-dasharray="5,3"/>
  <polygon points="235,355 242,351 242,359" fill="#1F2937"/>
  <text x="310" y="350" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#64748B">sessionToken</text>
  
  <!-- Divider for else -->
  <line x1="100" y1="370" x2="620" y2="370" stroke="#8B5CF6" stroke-width="1" stroke-dasharray="4,2"/>
  <text x="135" y="382" text-anchor="start" font-family="Arial, sans-serif" font-size="8" fill="#8B5CF6">[else] AuthException</text>
  
  <!-- Divider for outer else -->
  <line x1="60" y1="400" x2="635" y2="400" stroke="#6366F1" stroke-width="1" stroke-dasharray="4,2"/>
  <text x="95" y="410" text-anchor="start" font-family="Arial, sans-serif" font-size="8" fill="#6366F1">[else] User not found</text>
  
  <!-- Return to user -->
  <line x1="225" y1="425" x2="95" y2="425" stroke="#1F2937" stroke-width="1.5" stroke-dasharray="5,3"/>
  <polygon points="95,425 102,421 102,429" fill="#1F2937"/>
  <text x="160" y="438" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#64748B">displayResult()</text>
  
  <!-- Caption -->
  <text x="350" y="468" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#9CA3AF">Figure 3.8: Sequence Diagram Example - Login with Nested Alternatives</text>
</svg>
