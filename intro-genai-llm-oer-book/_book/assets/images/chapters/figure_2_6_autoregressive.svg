<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 500">
  <!-- Title -->
  <text x="400" y="30" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#2c3e50">
    Figure 2.6: Autoregressive Generation - Building Responses Token by Token
  </text>
  
  <!-- User question -->
  <rect x="200" y="60" width="400" height="40" fill="#3498db" stroke="#2980b9" stroke-width="2" rx="5"/>
  <text x="400" y="85" font-family="Arial, sans-serif" font-size="13" font-weight="bold" text-anchor="middle" fill="white">
    User Query: "What is machine learning?"
  </text>
  
  <!-- Arrow -->
  <path d="M 400 100 L 400 130" stroke="#34495e" stroke-width="2" marker-end="url(#arrowdown)"/>
  
  <!-- Token 1 -->
  <g id="token1">
    <rect x="100" y="130" width="600" height="50" fill="#e8f4f8" stroke="#3498db" stroke-width="2" rx="5"/>
    <text x="120" y="160" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#2980b9">
      Step 1:
    </text>
    <text x="200" y="160" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">
      Process entire question →
    </text>
    <rect x="420" y="140" width="100" height="30" fill="#27ae60" stroke="#229954" stroke-width="2" rx="3"/>
    <text x="470" y="162" font-family="Arial, sans-serif" font-size="13" font-weight="bold" text-anchor="middle" fill="white">
      "Machine"
    </text>
  </g>
  
  <!-- Arrow -->
  <path d="M 400 180 L 400 210" stroke="#7f8c8d" stroke-width="2" marker-end="url(#arrowdown)"/>
  
  <!-- Token 2 -->
  <g id="token2">
    <rect x="100" y="210" width="600" height="50" fill="#e8f4f8" stroke="#3498db" stroke-width="2" rx="5"/>
    <text x="120" y="240" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#2980b9">
      Step 2:
    </text>
    <text x="200" y="240" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">
      Question + "Machine" →
    </text>
    <rect x="420" y="220" width="100" height="30" fill="#27ae60" stroke="#229954" stroke-width="2" rx="3"/>
    <text x="470" y="242" font-family="Arial, sans-serif" font-size="13" font-weight="bold" text-anchor="middle" fill="white">
      "learning"
    </text>
  </g>
  
  <!-- Arrow -->
  <path d="M 400 260 L 400 290" stroke="#7f8c8d" stroke-width="2" marker-end="url(#arrowdown)"/>
  
  <!-- Token 3 -->
  <g id="token3">
    <rect x="100" y="290" width="600" height="50" fill="#e8f4f8" stroke="#3498db" stroke-width="2" rx="5"/>
    <text x="120" y="320" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#2980b9">
      Step 3:
    </text>
    <text x="200" y="320" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">
      Question + "Machine learning" →
    </text>
    <rect x="420" y="300" width="100" height="30" fill="#27ae60" stroke="#229954" stroke-width="2" rx="3"/>
    <text x="470" y="322" font-family="Arial, sans-serif" font-size="13" font-weight="bold" text-anchor="middle" fill="white">
      "is"
    </text>
  </g>
  
  <!-- Continuation indicator -->
  <text x="400" y="370" font-family="Arial, sans-serif" font-size="14" text-anchor="middle" fill="#7f8c8d">
    ... continues token by token ...
  </text>
  
  <!-- Final output box -->
  <rect x="100" y="390" width="600" height="80" fill="#2ecc71" stroke="#27ae60" stroke-width="3" rx="8"/>
  <text x="400" y="415" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">
    Complete Response
  </text>
  <text x="120" y="440" font-family="Arial, sans-serif" font-size="12" text-anchor="start" fill="white">
    "Machine learning is a field of artificial intelligence that enables
  </text>
  <text x="120" y="458" font-family="Arial, sans-serif" font-size="12" text-anchor="start" fill="white">
    computers to learn from data without being explicitly programmed..."
  </text>
  
  <!-- Key insight -->
  <rect x="150" y="485" width="500" height="10" fill="#f39c12" rx="5"/>
  <text x="400" y="500" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#7f8c8d" font-style="italic">
    Each token considers all previous context + model's learned knowledge
  </text>
  
  <!-- Arrow marker -->
  <defs>
    <marker id="arrowdown" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <path d="M0,0 L0,6 L9,3 z" fill="#34495e"/>
    </marker>
  </defs>
</svg>
