<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 550">
  <!-- Title -->
  <text x="400" y="30" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#2c3e50">
    Figure 2.4: Pre-training Process - Learning Language Patterns at Massive Scale
  </text>
  
  <!-- Training Data Sources -->
  <g id="data-sources">
    <text x="400" y="70" font-family="Arial, sans-serif" font-size="15" font-weight="bold" text-anchor="middle" fill="#34495e">
      Training Data Sources (Trillions of Tokens)
    </text>
    
    <!-- Books -->
    <rect x="50" y="90" width="130" height="60" fill="#3498db" stroke="#2980b9" stroke-width="2" rx="5"/>
    <text x="115" y="115" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="white">ğŸ“š Books</text>
    <text x="115" y="135" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">Literature, textbooks,</text>
    <text x="115" y="147" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">reference materials</text>
    
    <!-- Web Pages -->
    <rect x="200" y="90" width="130" height="60" fill="#9b59b6" stroke="#8e44ad" stroke-width="2" rx="5"/>
    <text x="265" y="115" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="white">ğŸŒ Web Pages</text>
    <text x="265" y="135" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">Articles, forums,</text>
    <text x="265" y="147" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">conversations</text>
    
    <!-- Academic Papers -->
    <rect x="350" y="90" width="130" height="60" fill="#27ae60" stroke="#229954" stroke-width="2" rx="5"/>
    <text x="415" y="115" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="white">ğŸ“ Papers</text>
    <text x="415" y="135" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">Research, journals,</text>
    <text x="415" y="147" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">scientific texts</text>
    
    <!-- Code -->
    <rect x="500" y="90" width="130" height="60" fill="#e67e22" stroke="#d35400" stroke-width="2" rx="5"/>
    <text x="565" y="115" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="white">ğŸ’» Code</text>
    <text x="565" y="135" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">GitHub, Stack</text>
    <text x="565" y="147" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">Overflow, docs</text>
    
    <!-- News -->
    <rect x="650" y="90" width="130" height="60" fill="#e74c3c" stroke="#c0392b" stroke-width="2" rx="5"/>
    <text x="715" y="115" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="white">ğŸ“° News</text>
    <text x="715" y="135" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">Articles, reports,</text>
    <text x="715" y="147" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">journalism</text>
  </g>
  
  <!-- Arrows converging -->
  <path d="M 115 150 L 200 200" stroke="#7f8c8d" stroke-width="2"/>
  <path d="M 265 150 L 250 200" stroke="#7f8c8d" stroke-width="2"/>
  <path d="M 415 150 L 350 200" stroke="#7f8c8d" stroke-width="2"/>
  <path d="M 565 150 L 450 200" stroke="#7f8c8d" stroke-width="2"/>
  <path d="M 715 150 L 550 200" stroke="#7f8c8d" stroke-width="2"/>
  
  <!-- Training Process Box -->
  <rect x="150" y="200" width="500" height="120" fill="#f8f9fa" stroke="#34495e" stroke-width="3" rx="8"/>
  
  <text x="400" y="230" font-family="Arial, sans-serif" font-size="15" font-weight="bold" text-anchor="middle" fill="#2c3e50">
    The Training Objective: Predict the Next Token
  </text>
  
  <rect x="180" y="245" width="440" height="60" fill="white" stroke="#3498db" stroke-width="1" rx="5"/>
  <text x="200" y="265" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">
    Given: "The capital of France is ___"
  </text>
  <text x="200" y="285" font-family="Arial, sans-serif" font-size="12" fill="#27ae60" font-weight="bold">
    Model predicts: "Paris"
  </text>
  <text x="490" y="265" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d" font-style="italic">
    Repeated billions
  </text>
  <text x="490" y="280" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d" font-style="italic">
    of times with
  </text>
  <text x="490" y="295" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d" font-style="italic">
    different texts
  </text>
  
  <!-- Arrow down -->
  <path d="M 400 320 L 400 360" stroke="#34495e" stroke-width="3" marker-end="url(#arrowblack2)"/>
  
  <!-- What Emerges -->
  <rect x="100" y="360" width="600" height="160" fill="#eef6ff" stroke="#3498db" stroke-width="2" rx="8"/>
  
  <text x="400" y="390" font-family="Arial, sans-serif" font-size="15" font-weight="bold" text-anchor="middle" fill="#2c3e50">
    What the Model Learns (Emergent Capabilities)
  </text>
  
  <g id="capabilities">
    <text x="130" y="420" font-family="Arial, sans-serif" font-size="13" fill="#2c3e50">
      âœ“ Grammar and syntax across languages
    </text>
    <text x="130" y="445" font-family="Arial, sans-serif" font-size="13" fill="#2c3e50">
      âœ“ Factual knowledge about the world
    </text>
    <text x="130" y="470" font-family="Arial, sans-serif" font-size="13" fill="#2c3e50">
      âœ“ Logical reasoning and cause-effect
    </text>
    <text x="130" y="495" font-family="Arial, sans-serif" font-size="13" fill="#2c3e50">
      âœ“ Cultural context and references
    </text>
    
    <text x="450" y="420" font-family="Arial, sans-serif" font-size="13" fill="#2c3e50">
      âœ“ Domain expertise (medicine, law, etc.)
    </text>
    <text x="450" y="445" font-family="Arial, sans-serif" font-size="13" fill="#2c3e50">
      âœ“ Writing style and tone variation
    </text>
    <text x="450" y="470" font-family="Arial, sans-serif" font-size="13" fill="#2c3e50">
      âœ“ Creative expression patterns
    </text>
    <text x="450" y="495" font-family="Arial, sans-serif" font-size="13" fill="#2c3e50">
      âœ“ Coding and technical patterns
    </text>
  </g>
  
  <!-- Stats box -->
  <rect x="200" y="530" width="400" height="10" fill="#f39c12" rx="5"/>
  <text x="400" y="545" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#7f8c8d" font-style="italic">
    Duration: Months | Cost: Millions of dollars | Compute: Thousands of GPUs
  </text>
  
  <!-- Arrow marker -->
  <defs>
    <marker id="arrowblack2" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <path d="M0,0 L0,6 L9,3 z" fill="#34495e"/>
    </marker>
  </defs>
</svg>
